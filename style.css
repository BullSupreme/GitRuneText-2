/* === Reset & Base Styles === */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent; /* Remove tap highlight on mobile */
}

html {
    font-size: 16px;
    scroll-behavior: smooth;
    height: 100%; /* Ensure html takes full height */
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    background-color: #1a1a1a;
    color: #e0e0e0;
    line-height: 1.6;
    min-height: 100vh;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    height: 100%; /* Ensure body takes full height */
}

/* Game Wrapper for layout control */
#game-wrapper {
    display: flex;
    flex-direction: column; /* Default mobile: centers .container */
    align-items: center;
    width: 100%;
    height: 100%;
    overflow: hidden; /* Prevent wrapper from scrolling, panels will scroll */
}

body:not(.desktop-mode-active) #game-wrapper {
    padding: 20px; /* Original body padding for mobile mode */
    overflow-y: auto; /* Allow scrolling in mobile mode */
}


/* === Main Container === */
.container {
    background-color: #252526;
    border: 1px solid #333;
    padding: 20px;
    padding-top: 50px; /* Space for top controls */
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
    position: relative;
    transition: all 0.3s ease; /* For hover effect */
    margin-top: 24px; /* Original margin for mobile */
    width: 100%; /* Ensure it takes width within #game-wrapper in mobile */
    max-width: 900px; /* Original max-width for mobile */
    display: flex; /* To allow sections to stack and center */
    flex-direction: column;
    align-items: center; /* Center .section children */
}
/* === Fire Effect === */
@keyframes subtleFire {
    0%, 100% { box-shadow: 0 0 5px 0 rgba(229, 5, 5, 0.3), 0 0 10px rgba(0,0,0,0.5); border-color: rgb(255, 69, 0); }
    25%, 75% { box-shadow: 0 0 7px 2px rgba(255, 140, 0, 0.4), 0 0 10px rgba(0,0,0,0.5); border-color: rgb(255, 140, 0); }
    50% { box-shadow: 0 0 10px 5px rgba(255, 69, 0, 0.5), 0 0 10px rgba(0,0,0,0.5); border-color: rgb(255, 69, 0); }
}
.container:hover {
    border-color: rgb(55, 163, 159); /* Original on hover */
    border-radius: 10px; /* Added for hover */
    /* Fire effect border animation on hover */
    animation: subtleFire 8s infinite;
}

/* === Headings & Links === */
h1, h2, h3, h4 {
    margin-bottom: 10px;
}

button, a {
    cursor: pointer;
    outline: none;
}

/* === Focus Styles === */
button:focus, a:focus, [tabindex]:focus {
    outline: 2px solid #4caf50;
    outline-offset: 2px;
}

/* === Hover Opacity (for devices that support hover) === */
@media (hover: hover) {
    button:hover, a:hover {
        opacity: 0.9;
    }
}

/* === Touch Target Sizing (for touch devices) === */
@media (hover: none) {
    button, a, .skill-stat-container, .skill-resource {
        min-height: 44px;
        min-width: 44px;
    }
}

/* === Utility Classes === */
.hidden {
    display: none !important;
}

/* Text Color Utilities */
.fore-yellow { color: #dcdcaa !important; }
.fore-lightblack_ex { color: #a0a0a0 !important; }
.fore-cyan { color: #4ec9b0 !important; }
.fore-blue { color: #569cd6 !important; }
.fore-green { color: #4ec9b0 !important; } /* General green, distinct from skill-specific greens */
.fore-magenta { color: #c586c0 !important; }
.fore-red { color: #f44747 !important; }
.fore-orange { color: #ce9178 !important; }
.fore-white { color: #d4d4d4 !important; }
.fore-gold { color: #ffd700 !important; }

/* Item Tier Border Colors */
.item-card-tier { /* Base style for items that will have a tier border */
    border: 2px solid transparent;
}
.tier-common { border-color: grey !important; }
.tier-uncommon { border-color: #4caf50 !important; }
.tier-rare { border-color: rgb(26, 129, 199) !important; }
.tier-epic { border-color: purple !important; }
.tier-legendary { border-color: red !important; }

/* === Enchantment Stat Tier Colors === */
.tier-common-stat { color: #9e9e9e !important; }
.tier-uncommon-stat { color: #4caf50 !important; }
.tier-rare-stat { color: #1a81c7 !important; }
.tier-epic-stat { color: #a855f7 !important; }
.tier-legendary-stat { color: #ef4444 !important; }
.tier-wizard-stat { color: #ff69b4 !important; } /* Pink for Wizard Tower enchantments */

/* === Top Controls (Save/Load/Settings) === */
.top-controls {
    position: absolute; top: 10px; left: 10px; display: flex; gap: 5px; z-index: 1001;
}

.top-right-controls {
    position: absolute; top: 10px; right: 20px; z-index: 1001;
}

.top-controls button,
.top-right-controls button,
.settings-btn { /* Added .settings-btn */
    padding: 7px 12px; font-size: 0.9em; background-color: #333; color: #fff; border: 1px solid #555; border-radius: 3px;
}
.settings-btn { /* Specific style for cogwheel */
    font-size: 1.2em;
    padding: 5px 10px;
}

.top-controls button:hover,
.top-right-controls button:hover,
.settings-btn:hover {
    background-color: #444; opacity: 1;
}

/* === Settings Modal === */
.settings-modal-content { /* Class applied to modal-content for settings */
    background: linear-gradient(135deg, #2c2c2e 0%, #1e1e20 100%);
    border: 2px solid #444;
    border-radius: 15px;
    padding: 30px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.4);
}
.settings-modal-content h3 {
    text-align: center;
    margin-bottom: 25px;
    color: #ffd700;
    font-size: 1.8em;
    font-family: 'Cinzel', 'Georgia', serif;
    text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    border-bottom: 2px solid #ffd700;
    padding-bottom: 15px;
    letter-spacing: 1px;
}
.setting-option {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    margin: 10px 0;
    background: rgba(255,255,255,0.05);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.1);
    transition: all 0.3s ease;
}
.setting-option:hover {
    background: rgba(255,255,255,0.08);
    border-color: #ffd700;
    transform: translateX(5px);
}
.setting-option label {
    color: #e0e0e0;
    font-size: 1.1em;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 10px;
}
.sound-controls {
    display: flex;
    align-items: center;
    gap: 15px;
}
.settings-toggle-btn.icon-btn {
    padding: 8px 12px;
    font-size: 1.3em;
    min-width: 50px;
}
.settings-toggle-btn, .settings-action-btn {
    padding: 10px 20px;
    font-size: 1em;
    background: linear-gradient(135deg, #444 0%, #555 100%);
    color: #fff;
    border: 2px solid #666;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    min-width: 150px;
    text-align: center;
}
.settings-toggle-btn:hover, .settings-action-btn:hover {
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
    color: #1a1a1a;
    border-color: #ffd700;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255,215,0,0.3);
    opacity: 1;
}
.settings-modal-content .modal-buttons {
    margin-top: 30px;
    justify-content: center; /* Center close button */
}
.settings-modal-content .btn-back {
    padding: 12px 30px;
    font-size: 1.1em;
    background: linear-gradient(135deg, #c9302c 0%, #e04440 100%);
    border: 2px solid #e04440;
    font-weight: 600;
    transition: all 0.3s ease;
}
.settings-modal-content .btn-back:hover {
    background: linear-gradient(135deg, #e04440 0%, #c9302c 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(224,68,64,0.3);
}
.settings-divider {
    height: 1px;
    background: linear-gradient(90deg, transparent 0%, #666 50%, transparent 100%);
    margin: 20px 0;
}
.settings-danger-btn {
    background: linear-gradient(135deg, #c9302c 0%, #a02622 100%) !important;
    border-color: #c9302c !important;
}
.settings-danger-btn:hover {
    background: linear-gradient(135deg, #e04440 0%, #c9302c 100%) !important;
    border-color: #e04440 !important;
}
.cheat-code-option .cheat-input-group {
    display: flex;
    gap: 10px;
    align-items: center;
}
.settings-input {
    padding: 8px 12px;
    background: #1a1a1a;
    border: 2px solid #444;
    border-radius: 6px;
    color: #e0e0e0;
    font-size: 1em;
    width: 150px;
    transition: all 0.3s ease;
}
.settings-input:focus {
    outline: none;
    border-color: #ffd700;
    background: #252525;
    box-shadow: 0 0 8px rgba(255,215,0,0.2);
}
.settings-slider {
    width: 150px;
    height: 6px;
    background: #1a1a1a;
    border-radius: 5px;
    outline: none;
    transition: all 0.3s ease;
    cursor: pointer;
    border: 1px solid #444;
    margin-right: 10px;
}
.settings-slider::-webkit-slider-thumb {
    appearance: none;
    width: 18px;
    height: 18px;
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid #666;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    transition: all 0.3s ease;
}
.settings-slider::-webkit-slider-thumb:hover {
    background: linear-gradient(135deg, #ffed4e 0%, #ffd700 100%);
    transform: scale(1.1);
    box-shadow: 0 3px 8px rgba(255,215,0,0.4);
}
.settings-slider::-moz-range-thumb {
    width: 18px;
    height: 18px;
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid #666;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
#music-volume-display {
    color: #ffd700;
    font-weight: 600;
    min-width: 40px;
    text-align: right;
}
.cheat-input-group .settings-action-btn {
    min-width: 80px;
    padding: 8px 15px;
}

/* === Desktop Mode Specific Styles === */
body.desktop-mode-active #game-wrapper {
    flex-direction: row;
    align-items: stretch;
    padding: 0;
}

body.desktop-mode-active .left-panel {
    width: 260px;
    background-color: #1e1e1e;
    border-right: 1px solid #3c3c3c;
    padding: 15px 10px;
    overflow-y: auto;
    display: flex; /* Will be made flex by JS */
    flex-direction: column;
    gap: 8px;
    color: #c5c5c5;
    z-index: 100;
    flex-shrink: 0;
}

body.desktop-mode-active .container {
    flex-grow: 1;
    overflow-y: auto;
    padding: 0;
    margin: 0;
    max-width: none;
    background-color: #252526;
    border: none;
    box-shadow: none;
    display: block; /* Changed from flex */
    align-items: initial; /* Revert from center */
}

body.desktop-mode-active .top-controls,
body.desktop-mode-active .top-right-controls {
    position: fixed;
    background: rgba(30,30,30,0.8);
    padding: 5px;
    border-radius: 0 0 5px 0;
}
body.desktop-mode-active .top-right-controls {
    border-radius: 0 0 0 5px;
}

body.desktop-mode-active .container > .section {
    margin-left: auto;
    margin-right: auto;
    max-width: 100%;
    width: 100%;
    padding: 20px;
    margin-top: 20px;
    margin-bottom: 20px;
}
body.desktop-mode-active .container > #main-menu-section {
     margin-top: 20px;
}

body.desktop-mode-active #hud,
body.desktop-mode-active .hp-bar-container {
    position: sticky;
    top: 0;
    z-index: 1000;
    background-color: #252526; /* Match parent background */
    width: 100%;
    max-width: none;
    margin-left: 0;
    margin-right: 0;
    border-bottom: 1px solid #333;
}

/* Desktop mode HUD layout restructure */
body.desktop-mode-active #hud {
    flex-direction: row;
    align-items: center;
    justify-content: flex-start;
}

body.desktop-mode-active .hud-left {
    display: none; /* Hide skill HUD in desktop mode */
}

body.desktop-mode-active .hud-right {
    order: 1; /* Resource panel (Gold & Perk Points) goes first */
    width: 100%;
    justify-content: flex-start;
    margin-bottom: 0;
}
body.desktop-mode-active #hud {
    padding: 10px 20px;
    border-radius: 0;
    box-shadow: none;
    margin-bottom: 0;
}
body.desktop-mode-active .hp-bar-container {
    margin-top: 0;
    margin-bottom: 0;
    border-radius: 0;
    padding: 5px 20px;
    box-sizing: content-box;
    max-width: none;
    width: 60%;
    margin-left: auto;
    margin-right: auto;
}

.left-panel-nav-item {
    display: flex;
    align-items: flex-start;
    gap: 5px;
    position: relative;
    flex-direction: column;
    padding: 8px 12px;
    color: #c5c5c5;
    text-decoration: none;
    border-radius: 5px;
    transition: background-color 0.2s, color 0.2s;
    cursor: pointer;
    font-size: 0.95em;
    border: 1px solid transparent;
    width: 100%;
    box-sizing: border-box;
}

/* Container for icon and label */
.left-panel-nav-item-header {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
}

/* Level display for skill items */
.nav-item-level {
    font-size: 0.85em;
    color: #888;
    margin-left: auto;
}

/* Progress bar container for skill items */
.nav-item-progress-bar {
    width: 100%;
    height: 3px;
    background-color: #333;
    border-radius: 2px;
    overflow: hidden;
    margin-top: 4px;
}

/* Progress bar fill */
.nav-item-progress-fill {
    height: 100%;
    background-color: #4caf50;
    transition: width 0.3s ease;
    border-radius: 2px;
}

/* Skill-specific progress bar colors */
.left-panel-nav-item[data-target-section="combat-section"] .nav-item-progress-fill { background-color: #f44336; }
.left-panel-nav-item[data-target-section="woodcutting-section"] .nav-item-progress-fill { background-color: #4caf50; }
.left-panel-nav-item[data-target-section="mining-section"] .nav-item-progress-fill { background-color: #9e9e9e; }
.left-panel-nav-item[data-target-section="blacksmithing-menu-section"] .nav-item-progress-fill { background-color: #ff9800; }
.left-panel-nav-item[data-target-section="cooking-section"] .nav-item-progress-fill { background-color: #ffeb3b; }
.left-panel-nav-item[data-target-section="enchanting-section"] .nav-item-progress-fill { background-color: #9c27b0; }
.left-panel-nav-item[data-target-section="farming-section"] .nav-item-progress-fill { background-color: #8bc34a; }
.left-panel-nav-item:hover {
    background-color: #333337;
    color: #fff;
    border-color: #444;
}
.left-panel-nav-item.active-nav {
    background-color: #0e639c;
    color: white;
    font-weight: 600;
    border-color: #1177bb;
}
.nav-item-icon {
    font-size: 1.1em;
    width: 20px;
    text-align: center;
    flex-shrink: 0;
}
.nav-item-label {
    flex-grow: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.left-panel.hidden {
    display: none !important;
}


/* === HUD (Heads-Up Display) === */
#hud {
    background-color: #2d2d2d;
    border-radius: 5px;
    padding: 15px;
    margin-bottom: 20px;
    display: flex;
    flex-wrap: wrap;
    align-items: flex-start;
    justify-content: space-between;
}

.hud-left {
    display: flex; gap: 15px; flex: 1; flex-wrap: wrap;
}

.hud-right {
    display: flex; gap: 15px; justify-content: flex-end; flex-wrap: wrap;
}

/* General Stat Container in HUD */
.stat-container {
    display: flex; align-items: center; gap: 5px; padding: 5px 10px; border-radius: 4px; position: relative; /* For tooltips and indicators */
}

/* Clickable Skill Stat Container in HUD */
.skill-stat-container {
    cursor: pointer; transition: background-color 0.2s, transform 0.3s ease, border 0.3s ease; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: 1px solid transparent; /* For hover effect space */
}

.skill-stat-container:hover {
    background-color: rgba(255, 255, 255, 0.1); transform: scale(1.009); border-radius: 10%;
}

.skill-stat-container.active-hud-item {
    background-color: rgba(76, 175, 80, 0.2); /* Example active color */
    border-left: 2px solid #4caf50;
}

.skill-stat-container.active-hud-item .auto-status-indicator {
    display: block; /* Show pulsing dot when skill is active */
}

/* HUD Stat Icon and Info */
.stat-icon {
    width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 18px;
}

.stat-info {
    display: flex; flex-direction: column;
}

.stat-label {
    font-size: 12px; color: #aaa;
}

.stat-value,
.hud-skill-level-text {
    font-weight: 500;
}

/* Specific HUD element styling */
#hud-player-hp { display: none; /* Initially hidden, shown by JS */ }

/* Gold Display HUD */
#hud-gold-display {
    position: relative; /* For tooltip */
    border: 1px solid transparent;
    border-radius: 10%;
}
#hud-gold-display:hover {
    transform: scale(1.05); border: 1px solid #ffd700; border-radius: 10%; animation: subtleCircleGlow 2s infinite alternate; background-color: rgba(255, 223, 0, 0.2);
}
.gold-tooltip-text {
    visibility: hidden; width: 60px; background-color: #333; color: #ffd700;
    text-align: center; border-radius: 5px; padding: 5px 0; position: absolute;
    z-index: 1; top: 110%; left: 50%; margin-left: -30px; opacity: 0; transition: opacity 0.3s;
}
#hud-gold-display:hover .gold-tooltip-text { visibility: visible; opacity: 1; }

/* Perk Points Display HUD */
#hud-perk-points-display {
    position: relative; /* For tooltip */
    border: 1px solid transparent;
    border-radius: 5px;
}
#hud-perk-points-display:hover {
    transform: scale(1.05); border: 1px solid #1ec469; border-radius: 10%; animation: subtlePerkGlow 2s infinite alternate; background-color: rgba(30, 196, 105, 0.2);
}
.perk-tooltip-text {
    visibility: hidden; width: 89px; background-color: #333; color: #1ec469;
    text-align: center; border-radius: 5px; padding: 5px 0; position: absolute;
    z-index: 1; top: 110%; left: 40%; margin-left: -30px; opacity: 0; transition: opacity 0.3s;
}
#hud-perk-points-display:hover .perk-tooltip-text { visibility: visible; opacity: 1; }

/* Animations for HUD items */
@keyframes subtleCircleGlow { /* Gold */
    0%, 100% { box-shadow: 0 0 10px 2px rgba(255, 215, 0, 0.8), 0 0 15px 5px rgba(255, 255, 255, 0.5); }
    50% { box-shadow: 0 0 20px 5px rgba(255, 215, 0, 1), 0 0 25px 10px rgba(255, 255, 255, 0.7); }
}
@keyframes subtlePerkGlow { /* Perk Green/Blue */
    0%, 100% { box-shadow: 0 0 10px 2px rgba(30, 196, 105, 0.8), 0 0 15px 5px rgba(0, 191, 255, 0.5); }
    50% { box-shadow: 0 0 20px 5px rgba(30, 196, 105, 1), 0 0 25px 10px rgba(0, 191, 255, 0.7); }
}
@keyframes woodcuttingGlow {
    0%, 100% { box-shadow: 0 0 10px 2px rgba(76, 175, 80, 0.8), 0 0 15px 5px rgba(255, 255, 255, 0.5); }
    50% { box-shadow: 0 0 20px 5px rgba(76, 175, 80, 1), 0 0 25px 10px rgba(255, 255, 255, 0.7); }
}
@keyframes miningGlow {
    0%, 100% { box-shadow: 0 0 10px 2px rgba(158, 158, 158, 0.8), 0 0 15px 5px rgba(255, 255, 255, 0.5); }
    50% { box-shadow: 0 0 20px 5px rgba(158, 158, 158, 1), 0 0 25px 10px rgba(255, 255, 255, 0.7); }
}
@keyframes blacksmithingGlow {
    0%, 100% { box-shadow: 0 0 10px 2px rgba(255, 152, 0, 0.8), 0 0 15px 5px rgba(255, 255, 255, 0.5); }
    50% { box-shadow: 0 0 20px 5px rgba(255, 152, 0, 1), 0 0 25px 10px rgba(255, 255, 255, 0.7); }
}
@keyframes cookingGlow {
    0%, 100% { box-shadow: 0 0 10px 2px rgba(255, 235, 59, 0.8), 0 0 15px 5px rgba(255, 255, 255, 0.5); }
    50% { box-shadow: 0 0 20px 5px rgba(255, 235, 59, 1), 0 0 25px 10px rgba(255, 255, 255, 0.7); }
}
@keyframes attackGlow {
    0%, 100% { box-shadow: 0 0 10px 2px rgba(244, 67, 54, 0.8), 0 0 15px 5px rgba(255, 255, 255, 0.5); }
    50% { box-shadow: 0 0 20px 5px rgba(244, 67, 54, 1), 0 0 25px 10px rgba(255, 255, 255, 0.7); }
}

/* Skill-specific hover styles */
.skill-stat-container[data-skill="attack"]:hover { border: 1px solid #f44336; animation: attackGlow 2s infinite alternate; background-color: rgba(244, 67, 54, 0.2); }
.skill-stat-container[data-skill="woodcutting"]:hover { border: 1px solid #4caf50; animation: woodcuttingGlow 2s infinite alternate; background-color: rgba(76, 175, 80, 0.2); }
.skill-stat-container[data-skill="mining"]:hover { border: 1px solid #9e9e9e; animation: miningGlow 2s infinite alternate; background-color: rgba(158, 158, 158, 0.2); }
.skill-stat-container[data-skill="blacksmithing"]:hover { border: 1px solid #ff9800; animation: blacksmithingGlow 2s infinite alternate; background-color: rgba(255, 152, 0, 0.2); }
.skill-stat-container[data-skill="cooking"]:hover { border: 1px solid #ffeb3b; animation: cookingGlow 2s infinite alternate; background-color: rgba(255, 235, 59, 0.2); }

/* Skill-specific label colors on hover */
.skill-stat-container[data-skill="attack"]:hover .stat-label { color: #f44336; }
.skill-stat-container[data-skill="woodcutting"]:hover .stat-label { color: #4caf50; }
.skill-stat-container[data-skill="mining"]:hover .stat-label { color: #9e9e9e; }
.skill-stat-container[data-skill="blacksmithing"]:hover .stat-label { color: #ff9800; }
.skill-stat-container[data-skill="cooking"]:hover .stat-label { color: #ffeb3b; }

/* Auto Status Indicator (pulsing dot for active skills) */
.auto-status-indicator {
    position: absolute; top: 3px; right: 3px; width: 8px; height: 8px;
    border-radius: 50%; background-color: #4caf50; box-shadow: 0 0 3px #4caf50;
    animation: pulse 1.5s infinite; display: none; /* Hidden by default */
}
@keyframes pulse {
    0% { transform: scale(0.8); opacity: 0.7; }
    50% { transform: scale(1.2); opacity: 1; }
    100% { transform: scale(0.8); opacity: 0.7; }
}

/* HUD Tooltip (for skill names) */
.tooltip {
    position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
    background-color: #333; color: #fff; padding: 5px 10px; border-radius: 4px;
    font-size: 12px; white-space: nowrap; z-index: 100; pointer-events: none;
    opacity: 0; transition: opacity 0.2s; display: none; /* Hidden by default */
}
/* Tooltips disabled for skill containers */
.skill-stat-container .tooltip {
    display: none !important;
}


/* HUD XP Bar Styles */
.skill-xp-bar-container {
    width: 100px; height: 6px; background-color: #333;
    border-radius: 3px; overflow: hidden; margin-top: 3px;
}
.skill-xp-bar {
    height: 100%; border-radius: 3px; width: 0%; /* JS sets width */
    transition: width 0.3s;
}
.skill-xp-bar.atk { background-color: #f44336; } /* Attack Red */
.skill-xp-bar.wc { background-color: #4caf50; } /* Woodcutting Green */
.skill-xp-bar.mn { background-color: #9e9e9e; } /* Mining Gray */
.skill-xp-bar.bs { background-color: #ff9800; } /* Blacksmithing Orange */
.skill-xp-bar.ck { background-color: #ffeb3b; } /* Cooking Yellow */
.skill-xp-bar.en { background-color: #9c27b0; } /* Enchanting Purple */
.skill-xp-bar.fm { background-color: #8bc34a; } /* Farming Green */

/* Skill-specific hover effects */
#hud-atk:hover { background-color: rgba(244, 67, 54, 0.2); border-color: #f44336; }
#hud-wc:hover { background-color: rgba(76, 175, 80, 0.2); border-color: #4caf50; }
#hud-mi:hover { background-color: rgba(158, 158, 158, 0.2); border-color: #9e9e9e; }
#hud-bs:hover { background-color: rgba(255, 152, 0, 0.2); border-color: #ff9800; }
#hud-ck:hover { background-color: rgba(255, 235, 59, 0.2); border-color: #ffeb3b; }
#hud-en:hover { background-color: rgba(156, 39, 176, 0.2); border-color: #9c27b0; }
#hud-fa:hover { background-color: rgba(139, 195, 74, 0.2); border-color: #8bc34a; }

/* Locked/Unavailable Skill States */
.skill-stat-container.locked {
    position: relative;
    pointer-events: none;
    display: none !important;
}

.skill-stat-container.locked::before {
    content: "?";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 3em;
    font-weight: bold;
    color: #444;
    opacity: 0.9;
    z-index: 3;
    pointer-events: none;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
}

.skill-stat-container.locked::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(40, 40, 40, 0.85);
    z-index: 2;
    pointer-events: none;
}

.skill-stat-container.locked .stat-icon,
.skill-stat-container.locked .stat-info {
    opacity: 0.1;
}


/* === Main Menu HP Bar (below HUD) === */
.hp-bar-container {
    width: 100%; max-width: 100%; height: 20px; background-color: #333;
    border-radius: 5px; overflow: hidden; margin: 1px auto 1px; /* Tight margin */
    position: relative;
}
.hp-bar {
    height: 100%; background-color: #4caf50; /* Green by default */
    border-radius: 5px; width: 0%; /* JS sets width */
    transition: width 0.3s, background-color 0.3s;
}
.hp-text {
    position: absolute; left: 0; right: 0; top: 0; bottom: 0;
    display: flex; align-items: center; justify-content: center;
    color: white; font-weight: 500; font-size: 14px;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8); z-index: 1;
}
/* Low HP Warning for Main Menu HP Bar */
.hp-bar-container.hud-hp-low .hp-bar, /* Class on container */
#hud-hp.hud-hp-low .hp-bar { /* If #hud-hp is used and has .hp-bar child */
    background-color: #f44336 !important; /* Red for low HP, !important if needed */
    animation: pulse-red 1.5s infinite alternate;
}
@keyframes pulse-red {
    from { box-shadow: 0 0 8px rgba(255, 0, 0, 0.6), 0 0 3px rgba(255,0,0,0.4) inset; }
    to { box-shadow: 0 0 12px rgba(255, 0, 0, 0.9), 0 0 5px rgba(255,0,0,0.7) inset; }
}


/* === Generic Section Styles === */
.section {
    background-color: #222;
    border-radius: 5px;
    padding: 10px;
    margin-bottom: 5px; /* Space between sections if multiple were visible */
    width: 100%; /* Make sections take full width of their parent */
}

/* Simple Section Title */
.section-title {
    color: #e0e0e0;
    margin-bottom: 20px;
    text-align: center;
    font-size: 1.5em;
    border-bottom: 1px solid #444;
    padding-bottom: 10px;
}

/* Section Header with Back Button etc. */
.section-title-header {
    display: flex; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #555; padding-bottom: 8px;
}
.section-title-text {
    font-weight: bold; flex-grow: 1; font-size: 1.2em; color: #e0e0e0;
}
.section-back-button, /* For Perk Tree, BS, Build Structures */
.btn-back-header { /* For old style if used */
    background-color: transparent; border: none; color: #e0e0e0; font-size: 1.6em;
    padding: 0 12px 0 0; margin: 0; cursor: pointer; font-weight: normal;
    line-height: 1; transition: color 0.2s ease, transform 0.2s ease, text-shadow 0.2s ease;
}
.section-back-button:hover,
.btn-back-header:hover {
    background-color: transparent; color: #fff; transform: scale(1.2);
    text-shadow: 0 0 8px #fff; opacity: 1;
}
.section-header-actions {
    margin-left: auto; display: flex; align-items: center;
}
.section-header-actions button {
    padding: 5px 10px; font-size: 0.9em; margin-left: 5px;
    background-color: #333; color: #fff; border: none; border-radius: 3px;
}
.section-header-actions button:hover { background-color: #444; opacity: 1; }

/* Section Footer Controls (often for a single Back button) */
.section-footer-controls {
    display: flex; align-items: center; border-top: 1px solid #555; padding-top: 15px; /* Increased from 8px */ margin-top: 20px; /* Increased from 15px */
}
.section-footer-controls button,
.btn-back { /* Generic back button style, often used in footers */
    margin: 0; padding: 10px 18px; background-color: #333;
    color: #fff; border: none; border-radius: 5px;
}
.section-footer-controls button:hover,
.btn-back:hover {
    background-color: #444; opacity: 1;
}

/* === Main Menu Section === */
#main-menu-section {
    /* Uses .section base style */
}
.welcome-text {
    text-align: center; margin-bottom: 30px; display: none; /* Shown by JS */
}
.welcome-text h2 { margin-bottom: 15px; }

/* Main Menu Buttons (Character, Inventory, Actions, Perks) */
.menu-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin-bottom: 30px;
}
.menu-button {
    background-color: #333; color: #fff; border: none; border-radius: 5px;
    padding: 12px; font-size: 14px; text-align: center;
    transition: background-color 0.2s, transform 0.2s ease-out;
    display: flex; flex-direction: column; align-items: center; gap: 5px;
}
.menu-button:hover {
    background-color: #444; opacity: 1;
    transform: translateY(-2px); /* Slight lift on hover */
}
.menu-button .button-icon {
    font-size: 24px; margin-bottom: 5px; display: inline-block;
    transition: transform 0.2s ease-out, filter 0.2s ease-out;
}
.menu-button:hover .button-icon {
    transform: scale(1.3); filter: drop-shadow(0 0 5px #fff);
}

/* Town Menu (Shop, Build, Farm, Guild Hall) */
.town-menu-container {
    margin-top: 30px; padding: 15px; background-color: #2d2d2d;
    border-radius: 5px; border: 1px solid #3d3d3d;
}
.town-menu-title {
    margin-bottom: 15px; color: #e0e0e0; text-align: center;
}
.town-button-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
}
.town-button {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    padding: 20px; background-color: #333; border-radius: 5px;
    transition: transform 0.2s, background-color 0.2s;
}
.town-button:hover {
    background-color: #444; transform: translateY(-3px); opacity: 1;
}
.town-button-icon {
    font-size: 28px; margin-bottom: 10px; display: inline-block;
    transition: transform 0.2s ease-out, filter 0.2s ease-out;
}
.town-button:hover .town-button-icon {
    transform: scale(1.3); filter: drop-shadow(0 0 5px #fff);
}
.town-button-text { font-weight: 500; }

/* Main Menu Footer (Reset, Cheat Codes) */
.main-menu-footer-controls {
    justify-content: space-between; /* Push reset to one side, cheat to other */
}
.cheat-code-container {
    display: flex; align-items: center; margin-right: auto; /* Pushes it left */
}
#cheat-input {
    width: 15ch; padding: 5px 8px; font-size: 0.9em; font-family: inherit;
    background-color: #1c1c1c; color: #d4d4d4; border: 1px solid #555;
    border-radius: 3px; box-sizing: border-box; margin-right: 5px;
}
#button-apply-cheat {
    background-color: #222224; color: #888; padding: 5px 10px;
    border: 1px solid #2d2d30; font-size: 0.85em; border-radius: 3px;
}
#button-apply-cheat:hover {
    background-color: #333335; color: #aaa; opacity: 1;
}
#reset-game-button { /* Specific styling for reset button if different from .btn-back */
    background-color: #c9302c; /* Red color for reset */
}
#reset-game-button:hover { background-color: #e04440; opacity: 1; }


/* === Compact Navigation Header (used in Skill sections like Mining, Woodcutting, Smelting etc.) === */
.compact-nav {
    display: flex; justify-content: space-between; align-items: center;
    background-color: #2d2d2d; border-radius: 5px;
    padding: 10px 15px; margin-bottom: 5px;
}
.compact-nav-title { font-weight: bold; font-size: 1.2em; }
.compact-nav-buttons { display: flex; gap: 10px; }
.compact-nav-button { /* e.g. Back button in compact nav */
    background-color: #333; color: #fff; border: none; border-radius: 4px;
    padding: 6px 10px; display: flex; align-items: center; gap: 5px;
    font-size: 0.9em; transition: background-color 0.2s;
}
.compact-nav-button:hover { background-color: #444; opacity: 1; }
.compact-nav-button-icon { font-size: 1.1em; } /* For emoji in button */

/* === Permit/Unlock Status Display (used in Skill sections) === */
.permit-status {
    background-color: rgba(76, 175, 80, 0.1); /* Default green tint for active */
    border-left: 3px solid #4caf50;
    padding: 10px 15px; margin-bottom: 20px; font-size: 0.9em; color: #e0e0e0;
}
.permit-status.inactive {
    background-color: rgba(244, 67, 54, 0.1); border-left-color: #f44336;
}

/* === Action Info Display (shows action timing) === */
.action-info {
    background-color: rgba(33, 150, 243, 0.1);
    border-left: 3px solid #2196f3;
    padding: 10px 15px; margin-bottom: 15px; font-size: 0.9em; color: #e0e0e0;
    text-align: center;
}

/* === Resource List & Items (Common for Mining, Woodcutting, Cooking, Smelting, Smithing etc.) === */
.resource-list {
    display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px;
}

/* Resource ingredient styling for recipes */
.resource-ingredient {
    color: #aaa; /* Light gray for ingredients */
}
.resource-ingredient-name {
    color: #e0e0e0; /* Brighter color for ingredient names */
}

/* Recipe styling for cooking */
.recipe {
    background-color: #2d2d30;
    border: 2px solid #3f3f46;
    border-radius: 5px;
    padding: 12px 15px;
    margin-bottom: 10px;
    transition: all 0.2s ease;
    position: relative;
    cursor: pointer;
}

.recipe:hover {
    background-color: #3e3e42;
    transform: translateY(-2px);
}

/* Active recipe styling */
.recipe.active-resource {
    border: 2px solid #4caf50;
    padding: 4px;
    border-radius: 4px;
}

.recipe-title {
    font-weight: 500;
    margin-bottom: 10px;
}

.recipe-ingredient {
    margin: 10px 0;
    color: #aaa;
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
}

.resource-ingredient { /* Re-defined for cooking recipe cards */
    text-align: center;
    padding: 5px;
    border-radius: 4px;
    background-color: rgba(0, 0, 0, 0.2);
    min-width: 80px;
    line-height: 1.4;
}

.ingredient-quantity {
    font-size: 0.9em;
}

.have-enough {
    color: #4caf50 !important; /* Ensure override */
}

.not-enough {
    color: #f44336 !important; /* Ensure override */
}

.recipe-xp {
    color: #4caf50;
    margin-top: 10px;
    font-weight: 500;
}

.recipe-available {
    /* Default styling for available recipes */
}

.recipe-locked {
    opacity: 0.6;
    cursor: not-allowed;
}

.level-req {
    color: #f44336;
    font-size: 0.9em;
    margin-top: 5px;
}
.skill-resource, /* Generic resource item that can be actioned */
.action-list-item { /* Alias for similar items */
    display: flex; justify-content: space-between; align-items: center;
    background-color: #2d2d30; border: 1px solid #3f3f46; border-radius: 5px;
    padding: 12px 15px; cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
    position: relative; /* For loot notifications */
}
.skill-resource:hover,
.action-list-item:hover {
    background-color: #3e3e42; transform: translateY(-2px); opacity: 1;
}

/* Active Action Item Styling */
.skill-resource.active-action-item,
.action-list-item.active-action-item {
    background-color: rgba(14, 99, 156, 0.2) !important;
    border-left: 3px solid #0e639c !important;
    color: #fff !important; box-shadow: 0 0 8px #0e639c;
}
.action-list-item-disabled { /* For non-clickable items */
    opacity: 0.6; cursor: not-allowed;
}
.action-list-item-disabled:hover { background-color: #2d2d30; transform: none; } /* Reset hover */

.resource-main-text, /* Main text of a skill resource */
.action-item-name {  /* Main text of an action item */
    flex: 1; font-weight: 500;
}
.resource-inventory-count { /* Current count of that resource in inventory */
    background-color: rgba(0, 0, 0, 0.3); padding: 3px 8px; border-radius: 10px;
    font-size: 0.85em; color: #dcdcaa; margin-left: 10px;
}
.action-item-level { /* Level requirement display */
    color: #a0a0a0; font-size: 0.9em; padding: 3px 8px;
    background-color: rgba(0, 0, 0, 0.3); border-radius: 10px;
}
.action-item-ingredients .have-enough { /* Ensure specificity for cooking actions */
    color: #4caf50 !important;
}
.action-item-ingredients .have-not-enough { /* Ensure specificity for cooking actions */
    color: #f44336 !important;
}

/* Loot/XP Notification (Pop-up text) */
.resource-loot-notification {
    font-size: 0.9em; color: #4caf50; margin: 0 10px;
    overflow: hidden; white-space: nowrap; text-overflow: ellipsis;
    max-width: 200px; opacity: 0; /* Controlled by JS and animation */
    position: absolute; /* Positioned relative to .skill-resource or .action-list-item */
    right: 30%; /* Example, adjust as needed */
    top: 50%; transform: translateY(-50%);
    background-color: rgba(20,20,20,0.8); padding: 2px 5px; border-radius: 3px;
}
.resource-loot-notification.active {
    animation: notification-fade 1.5s ease-in-out; opacity: 0; /* Animation handles fade */
}
@keyframes notification-fade {
    0% { opacity: 0; transform: translateY(-50%) scale(0.8); }
    15% { opacity: 1; transform: translateY(-60%) scale(1); } /* Move up slightly */
    70% { opacity: 1; transform: translateY(-65%) scale(1); }
    100% { opacity: 0; transform: translateY(-75%) scale(0.8); } /* Fade out further up */
}


/* === Mining & Woodcutting Sections === */
#mining-section,
#woodcutting-section {
    /* Use .section, .compact-nav, .permit-status, .resource-list */
}
/* Title for available ores/trees list within these sections */
#available-ores-list .section-title,
#available-trees-list .section-title {
    text-align:left; font-size:1.2em; border:none; padding-bottom:5px; margin-bottom: 10px;
}

/* === Character Section === */
#character-section { /* Uses .section base */ }
.character-content-wrapper {
  display: flex;
  flex-direction: row;
}
.character-stats-column {
  flex: 2 1 0;
  display: flex;
  flex-direction: column;
  gap: 0;
}
.character-equipment-column {
  flex: 1 1 0;
  display: flex;
  min-width: 220px;
  max-width: 320px;
}
@media (max-width: 900px) {
  .character-content-wrapper {
    flex-direction: column;
    gap: 0;
  }
  .character-equipment-column {
    max-width: 100%;
    margin-left: 0;
  }
}

/* Character Stats Display */
#char-info-target { /* Container for stats, often uses .stats-grid */ }
.stats-grid {
    display: grid; grid-template-columns: 1fr; gap: 10px;
}
.stat-row { /* Individual stat row, e.g., HP: 100/100 */
    display: flex; justify-content: space-between; padding: 8px 10px;
    border-bottom: 1px solid #333; position: relative; /* For tooltips */
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, background-color 0.2s ease-out;
    border-radius: 4px;
}
.stat-row:last-child { border-bottom: none; }
.stat-row:hover {
    transform: scale(1.03); background-color: rgba(76, 175, 80, 0.1);
    box-shadow: 0 0 8px rgba(76, 175, 80, 0.5); z-index: 10;
}
.stat-name { color: #aaa; }
/* .stat-value is defined in HUD styles, can be reused here */

/* Character Equipment Display */
.character-equipment-column h3 { /* "Equipped Gear" title */
    text-align:center; margin-top: 0; margin-bottom:10px; color:#90cdf4;
}
#equipment-display-target, /* Target for equipment slots */
.equipment-grid { /* Grid for equipment slots */
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
}
.equipment-slot {
    background-color: #333; border-radius: 5px; padding: 10px;
    display: flex; flex-direction: column; min-height: 120px;
}
.slot-name {
    color: #aaa; font-size: 0.9em; margin-bottom: 8px; text-align: center;
}
.slot-item { /* Container for the item icon and details within a slot */
    display: flex; flex-direction: column; align-items: center;
    background-color: #2a2a2a; border-radius: 4px; padding: 8px; flex-grow: 1;
}
.item-icon { /* Emoji for equipped item */
    font-size: 24px; margin-bottom: 5px;
}
.item-icon img,
.item-card-icon img,
.shop-item-icon img,
.sell-item .item-icon img,
.inventory-item .item-icon img.inventory-item-icon, /* Global rule from earlier */
.mining-resource .resource-icon img.inventory-item-icon { /* Global rule from earlier */
    width: 48px !important;
    height: 48px !important;
    object-fit: contain; /* Ensure aspect ratio is maintained */
}

.item-details { flex: 1; width: 100%; text-align: center; }
.item-name { /* Name of equipped item */
    font-weight: bold; margin-bottom: 8px; text-align: center; width: 100%;
    word-break: break-word;
}
.item-stats { /* Stats of equipped item */
    font-size: 0.85em; color: #4caf50; text-align: center; word-break: break-word;
}
/* Enchantment info in equipment slots */
.item-enchant-info, .item-enchant-count {
    font-size: 0.85em;
    margin-top: 3px;
    text-align: center;
}
/* Item Selection for Equipping */
#item-selection-for-equip-target { margin-top:10px; /* Initially hidden */ }
#equip-item-type-title-target { margin-bottom:10px; }
#equip-item-list-target { /* Uses .inventory-grid styling */ max-height:200px; }
#cancel-equip-btn {
    margin-top:10px; background-color:#555; color:white;
    border:none; padding:8px 15px; border-radius:4px;
}
#cancel-equip-btn:hover { background-color: #666; opacity: 1; }

/* Character Stat Tooltips (custom tooltips for the stats grid) */
.custom-tooltip-text {
    position: absolute; bottom: 100%; left: 50%;
    transform: translateX(-50%) translateY(-8px);
    background-color: #262626; color: #ccc; border: 1px solid #555;
    padding: 4px 8px; border-radius: 3px; font-size: 12px; line-height: 1.2;
    min-width: 120px; box-shadow: 0 1px 4px rgba(0,0,0,0.3);
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    z-index: 9999; /* Ensure tooltips sit above other tiles */
    transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out, transform 0.2s ease-in-out;
}
.stats-grid .stat-row:hover .custom-tooltip-text {
    opacity: 1; visibility: visible; transform: translateX(-50%) translateY(-12px);
}
/* Character Actions (Footer) */
.character-actions { /* Uses .section-footer-controls */ justify-content: flex-start; }


/* === Inventory Section === */
#inventory-section { /* Uses .section base */ }
.inventory-header {
    display: flex; justify-content: space-between; /* Align back button to right */
    align-items: center; margin-bottom: 15px; padding-bottom: 10px;
    border-bottom: 1px solid #444; flex-wrap: wrap; gap: 15px;
}
.inventory-stats { display: flex; gap: 20px; flex-wrap: wrap; }
.inventory-space, .inventory-value { font-weight: bold; color: #e0e0e0; }
.inventory-controls {
    display: flex; gap: 10px; flex-wrap: wrap; margin-left: auto; /* Pushes controls left of back button */
}
#inventory-sort-controls-target { display:flex; gap:5px; flex-wrap:wrap; }
/* Buttons/Filters in inventory controls */
.inventory-button, .inventory-filter {
    background-color: #333; color: #fff; border: 1px solid #555;
    border-radius: 4px; padding: 8px 14px; font-size: 1em;
}
.inventory-button:hover, .inventory-filter:hover { background-color: #444; opacity: 1; }
#inventory-back-btn { /* Specific back button in header */
    /* Uses .btn-back base styles, already covered by .section-footer-controls button */
    /* If it needs to be different from footer buttons, add styles here */
}

/* Inventory Grid */
#inventory-grid-target,
.inventory-grid { /* Shared by equip item list */
    display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 12px; margin-bottom: 20px; max-height: 500px; overflow-y: auto;
    padding-right: 5px; /* For scrollbar */ position: relative; z-index: 1;
}
.inventory-item {
    background-color: #333;
    /* border: 1px solid #444; Default border, tier borders will override if present */
    border-radius: 5px; padding: 10px; display: flex; flex-direction: column;
    align-items: center; transition: transform 0.1s, box-shadow 0.1s, background-color 0.1s;
    position: relative; z-index: 1; min-height: 96px;
}
.inventory-item:hover {
    background-color: #3a3a3a; transform: translateY(-2px);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); cursor: pointer; z-index: 100; opacity: 1;
}
/* Item rarity borders applied to .inventory-item directly if they don't use .item-card-tier */
.inventory-item.common { border-color: #777 !important; } /* Ensure these override default or transparent */
.inventory-item.uncommon { border-color: #4caf50 !important; }
.inventory-item.rare { border-color: #2196f3 !important; }
.inventory-item.epic { border-color: #9c27b0 !important; }
.inventory-item.legendary { border-color: #ff9800 !important; box-shadow: 0 0 5px rgba(255, 152, 0, 0.5) !important; }
.inventory-item.legendary:hover { box-shadow: 0 0 5px rgba(255, 152, 0, 0.5), 0 2px 5px rgba(0,0,0,0.3) !important; }
/* If .item-card-tier is used within .inventory-item, ensure its borders are visible */
.inventory-item .item-card-tier.tier-common { border-color: grey !important; }
.inventory-item .item-card-tier.tier-uncommon { border-color: #4caf50 !important; }
.inventory-item .item-card-tier.tier-rare { border-color: rgb(26, 129, 199) !important; }
.inventory-item .item-card-tier.tier-epic { border-color: purple !important; }
.inventory-item .item-card-tier.tier-legendary { border-color: red !important; }

/* Enchanted item styles */
.inventory-item.enchanted-item {
    background: linear-gradient(135deg, #2a2a3e 0%, #3a2a4e 100%);
    border: 2px solid #9370DB;
    box-shadow: 0 0 10px rgba(147, 112, 219, 0.3);
}

.inventory-item.enchanted-item:hover {
    box-shadow: 0 0 15px rgba(147, 112, 219, 0.5), 0 2px 5px rgba(0,0,0,0.3);
}

.item-enchantments {
    margin-top: 5px;
    font-size: 0.85em;
    line-height: 1.4;
}

.item-enchantments > div {
    margin: 2px 0;
}

.enchantment-count {
    color: #b19cd9;
    font-weight: bold;
    margin-top: 3px;
}


.inventory-item .item-icon { font-size: 34px; margin-bottom: 6px; }
.inventory-item .item-info { width: 100%; text-align: center; }
.inventory-item .item-name {
    font-size: 1em; margin-bottom: 4px; white-space: nowrap;
    overflow: hidden; text-overflow: ellipsis;
}
.inventory-item .item-quantity {
    font-size: 0.95em; color: #aaa; background-color: rgba(0, 0, 0, 0.3);
    border-radius: 10px; padding: 2px 6px; display: inline-block;
}

/* Inventory Item Tooltip */
.inventory-item .item-tooltip, /* Merged selector */
.shop-item .item-tooltip { /* New for shop */
    visibility: hidden;
    opacity: 0;
    width: 200px;
    background-color: #2d2d2d; /* Original color: #222 */
    color: #fff;
    text-align: left;
    border-radius: 6px;
    padding: 10px;
    position: absolute;
    z-index: 9999; /* Ensure it's above other elements */
    bottom: 100%; /* Adjusted from 115% */
    left: 50%;
    margin-left: -100px; /* Half of width to center */
    transition: opacity 0.3s ease; /* Standardized transition */
    pointer-events: none;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5); /* Standardized shadow */
    border: 1px solid #444;
}
.inventory-item .tooltip-box-inner { padding: 10px; } /* Keep if still used internally for inv */

.inventory-item .item-tooltip::after, /* Merged selector */
.shop-item .item-tooltip::after { /* New for shop */
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #2d2d2d transparent transparent transparent; /* Match tooltip background */
}
.inventory-item:hover .item-tooltip, /* Merged selector */
.shop-item:hover .item-tooltip { /* New for shop */
    visibility: visible;
    opacity: 1;
}
.tooltip-box-title { font-weight: bold; margin-bottom: 5px; color: #fff; border-bottom: 1px solid #555; padding-bottom: 5px; font-size: 1em; }
.tooltip-box-desc { font-size: 0.9em; margin-bottom: 5px; color: #ccc; }
.tooltip-box-stats, .tooltip-box-reqs, .tooltip-box-crafting { font-size: 0.85em; margin-bottom:5px; padding-bottom:5px; border-bottom: 1px solid #444; }
.tooltip-box-stats span, .tooltip-box-reqs span, .tooltip-box-crafting span { display:block; margin-bottom:2px; }
.tooltip-box-crafting ul { list-style: disc inside; padding-left:10px; margin-top:5px; }
.tooltip-box-crafting li { margin-bottom:2px; }
.tooltip-box-value { font-size: 0.85em; color: #ffcc00; margin-top: 5px; font-weight:bold; }
.tooltip-box-stats:last-child, .tooltip-box-reqs:last-child, .tooltip-box-crafting:last-child { border-bottom:none; padding-bottom:0; margin-bottom:0;}

/* Smart tooltip positioning classes */
/* Default: tooltip above, centered */
.inventory-item .item-tooltip,
.shop-item .item-tooltip {
    bottom: 100%;
    left: 50%;
    margin-left: -100px;
}

.inventory-item .item-tooltip::after,
.shop-item .item-tooltip::after {
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-color: #2d2d2d transparent transparent transparent;
}

/* Tooltip below (for top row items) */
.inventory-item.tooltip-below .item-tooltip,
.shop-item.tooltip-below .item-tooltip {
    bottom: auto;
    top: 100%;
    left: 50%;
    margin-left: -100px;
}

.inventory-item.tooltip-below .item-tooltip::after,
.shop-item.tooltip-below .item-tooltip::after {
    top: auto;
    bottom: 100%;
    left: 50%;
    margin-left: -5px;
    border-color: transparent transparent #2d2d2d transparent;
}

/* Tooltip to the right (for left edge items) */
.inventory-item.tooltip-right .item-tooltip,
.shop-item.tooltip-right .item-tooltip {
    bottom: auto;
    top: 50%;
    left: 100%;
    margin-left: 10px;
    margin-top: -50px;
}

.inventory-item.tooltip-right .item-tooltip::after,
.shop-item.tooltip-right .item-tooltip::after {
    top: 50%;
    left: auto;
    right: 100%;
    margin-top: -5px;
    margin-left: 0;
    border-color: transparent #2d2d2d transparent transparent;
}

/* Tooltip to the left (for right edge items) */
.inventory-item.tooltip-left .item-tooltip,
.shop-item.tooltip-left .item-tooltip {
    bottom: auto;
    top: 50%;
    left: auto;
    right: 100%;
    margin-right: 10px;
    margin-top: -50px;
}

.inventory-item.tooltip-left .item-tooltip::after,
.shop-item.tooltip-left .item-tooltip::after {
    top: 50%;
    left: 100%;
    right: auto;
    margin-top: -5px;
    margin-left: 0;
    border-color: transparent transparent transparent #2d2d2d;
}

/* Corner adjustments - tooltip below-right for top-left corner */
.inventory-item.tooltip-below-right .item-tooltip,
.shop-item.tooltip-below-right .item-tooltip {
    bottom: auto;
    top: 100%;
    left: 0;
    margin-left: 0;
}

.inventory-item.tooltip-below-right .item-tooltip::after,
.shop-item.tooltip-below-right .item-tooltip::after {
    top: auto;
    bottom: 100%;
    left: 20px;
    margin-left: 0;
    border-color: transparent transparent #2d2d2d transparent;
}

/* Corner adjustments - tooltip below-left for top-right corner */
.inventory-item.tooltip-below-left .item-tooltip,
.shop-item.tooltip-below-left .item-tooltip {
    bottom: auto;
    top: 100%;
    left: auto;
    right: 0;
    margin-left: 0;
}

.inventory-item.tooltip-below-left .item-tooltip::after,
.shop-item.tooltip-below-left .item-tooltip::after {
    top: auto;
    bottom: 100%;
    left: auto;
    right: 20px;
    margin-left: 0;
    border-color: transparent transparent #2d2d2d transparent;
}


/* Inventory Pagination (if used) */
.inventory-pagination {
    display: flex; justify-content: center; align-items: center;
    gap: 15px; margin-bottom: 15px;
}
.pagination-button {
    background-color: #333; color: #fff; border: none; border-radius: 4px;
    padding: 5px 10px;
}
.pagination-button:hover { background-color: #444; opacity: 1; }
.pagination-info { color: #aaa; }

/* Inventory Actions (Footer) */
.inventory-actions { /* Uses .section-footer-controls */ justify-content: flex-start; }
#inventory-footer-back-btn { /* Uses .btn-back styles */ }

/* Inventory Scrollbar */
.inventory-grid::-webkit-scrollbar { width: 8px; }
.inventory-grid::-webkit-scrollbar-track { background: #1a1a1a; border-radius: 4px; }
.inventory-grid::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
.inventory-grid::-webkit-scrollbar-thumb:hover { background: #555; }


/* === Shop Section === */
#shop-section { /* Uses .section base */ display: flex; flex-direction: column; }
.shop-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 20px; flex-wrap: wrap; gap: 15px;
}
.shop-stats .stat { font-size: 1.1em; display: flex; align-items: center; gap: 5px; }
.shop-stats .stat .stat-label { color: #aaa; }
.shop-stats .stat .gold-value { color: #dcdcaa; font-weight: bold; }
.shop-controls { /* Tab buttons container */ display: flex; gap: 10px; flex-wrap: wrap; }

/* Shop Tabs (Buy, Sell, etc.) */
.tabs { /* General container for tabs, used by Shop and Smithing */
    display: flex; gap: 10px; margin-bottom: 15px;
    flex-wrap: wrap; border-bottom: 2px solid #3f3f46;
}
.tab, .shop-tab-button, .smithing-tab { /* Common tab button style */
    background-color: #333; color: #fff; border: none;
    border-radius: 4px 4px 0 0; padding: 10px 20px;
    transition: background-color 0.2s, color 0.2s;
    font-weight: 500; border: 1px solid transparent; border-bottom: none;
}
.tab:hover, .shop-tab-button:hover, .smithing-tab:hover { background-color: #444; opacity: 1; }
.tab.active, .shop-tab-button.active-tab, .smithing-tab.active {
    background-color: #0e639c; color: white; border-color: #3f3f46;
    border-bottom: 2px solid #2d2d30; /* Match content background */
    position: relative; top: 2px;
}
/* Tab Content Area */
.tab-content { display: none; animation: fadeIn 0.3s ease-in-out; }
.tab-content.active { display: block; }
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Shop Item Grid and Cards (Buy Tab) */
#shop-items-container, .shop-grid { /* Grid for buyable items */
    display: grid; grid-template-columns: repeat(auto-fill, minmax(175px, 1fr)) !important;
    gap: 15px; overflow: visible !important; padding: 5px; flex-grow: 1;
}
.shop-item-card, .shop-item { /* Individual item card in the shop, ensure .shop-item also has base styling */
    background-color: #2d2d30; border: 1px solid #3f3f46; border-radius: 5px;
    padding: 15px; /* Increased padding from 5px */
    transition: transform 0.2s, background-color 0.2s, border-color 0.2s;
    display: flex; flex-direction: column; justify-content: space-between;
    min-height: 220px; /* Ensures consistent card height */
    position: relative; /* For tooltip */
}
.shop-item.item-card-tier { /* Applied to .shop-item which gets .item-card-tier class */
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center; /* Center content horizontally */
}

.shop-item-card:hover, .shop-item:hover { background-color: #3e3e42; transform: translateY(-2px); opacity: 1; }
.shop-item-card.selected {
    border-color: #0e639c; box-shadow: 0 0 10px rgba(14, 99, 156, 0.3);
}
/* Item card shared elements (can be reused if structure is similar) */
.item-card-icon,
.shop-item-icon,
.shop-item .item-icon { /* Ensure selector applies within .shop-item */
    font-size: 2em;
    width: auto;
    height: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 5px;
    margin: 2px auto 5px auto; /* Centered icon with margin adjustment */
}
.item-card-name,
.shop-item-name,
.shop-item .item-name { /* Ensure selector applies within .shop-item */
    font-weight: bold;
    font-size: 1.1em;
    margin-bottom: 5px; /* Adjusted margin */
    text-align: center;
    color: #e0e0e0;
}
.item-card-desc,
.shop-item .item-description { /* Ensure selector applies */
    font-size: 0.9em; color: #b0b0b0; margin-bottom: 2px; flex-grow: 1;
    line-height: 1.4; text-align: center; display: flex; align-items: center; justify-content: center;
}

.shop-item .item-icon-wrapper { /* For icon and price vertical stack */
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 10px;
}

.shop-item .item-info { /* For name, desc, details vertical stack */
    flex-grow: 1;
    width: 100%;
    display: flex;
    flex-direction: column;
    text-align: center;
    margin-bottom: 4px;
}
.shop-item .item-buy-section { /* For price and buy button vertical stack */
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: auto;
    width: 100%;
}

.shop-item-details,
.shop-item .item-details { /* Ensure selector applies */
    display: flex; flex-direction: column; gap: 5px; margin-top:auto; margin-bottom: 0; flex-grow: 1;
}
.shop-item-stat { display: flex; justify-content: space-between; font-size: 0.9em; }
.shop-item-stat-label { color: #a0a0a0; }
.item-card-cost, .shop-item-price,
.shop-item .item-price { /* Ensure selector applies */
    color: #dcdcaa; font-weight: bold; font-size: 1em; margin-bottom: 8px; text-align: center;
    display: flex; align-items: center; justify-content: center; gap: 4px;
    border-top:solid 2px;
    border-top-color: rgba(127, 255, 212, 0.35);
}
.item-card-buy-button, .shop-item-buy-btn,
.buy-button { /* Modern buy button style */
    padding: 8px 16px !important;
    font-size: 1.05em !important;
    background: linear-gradient(90deg, #28a745 0%, #218838 100%); /* Gradient background */
    color: white; border: 1px solid #1e7e34; border-radius: 5px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    transition: all 0.2s ease-in-out !important; /* Add transform */
    width: 100%; margin-top: 0; /* auto was pushing buy section up */
}
.buy-button:hover {
    background: linear-gradient(90deg, #218838 0%, #1e7e34 100%) !important; /* Darker gradient on hover */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4) !important;
    transform: translateY(-2px) scale(1.04) !important;
    opacity: 1 !important;
}
.buy-button:active {
    transform: translateY(0) scale(1) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
}

/* Shop Item Details Area (Right-hand panel for selected item, if used) */
.shop-details-area {
    flex: 1; background-color: #2d2d30; border-radius: 5px; padding: 20px;
    display: flex; flex-direction: column; min-height: 0; overflow-y: auto;
}
.shop-details-header { margin-bottom: 15px; border-bottom: 1px solid #3f3f46; padding-bottom: 10px; }
.shop-details-title { font-size: 1.2em; font-weight: bold; }
.shop-details-content { /* Where item detail view is injected */
    flex: 1; display: flex; align-items: center; justify-content: center;
    color: #a0a0a0; font-style: italic;
}
.shop-empty-message { /* For empty tabs or no selection */
    grid-column: 1 / -1; text-align: center; padding: 40px; color: #a0a0a0;
    font-style: italic; min-height: 200px; /* Adjusted from 400px */
    display: flex; align-items: center; justify-content: center;
}

/* Item Detail View (for shop-details-area if implemented from mockup) */
.item-detail-view { display: flex; flex-direction: column; height: 100%; }
.item-detail-header { display: flex; align-items: center; margin-bottom: 25px; gap: 15px; }
.item-detail-icon {
    font-size: 36px; width: 70px; height: 70px; display: flex; align-items: center; justify-content: center;
    background-color: rgba(0, 0, 0, 0.2); border-radius: 10px;
}
.item-detail-name { font-weight: bold; font-size: 1.6em; }
.item-detail-info { margin-bottom: 30px; font-size: 1.1em; }
.item-detail-info .shop-item-stat { margin-bottom: 12px; font-size: 1.1em; }
.item-detail-purchase {
    margin-top: auto; display: flex; justify-content: space-between; align-items: center;
    padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1);
}
.item-detail-price {
    color: #dcdcaa; font-weight: bold; font-size: 1.3em; display: flex; align-items: center; gap: 10px;
}
.item-detail-buy-btn {
    background-color: #0e639c; color: white; border: none; border-radius: 5px;
    padding: 10px 20px; font-weight: bold; font-size: 1.1em;
    transition: background-color 0.2s, transform 0.1s;
}
.item-detail-buy-btn:hover { background-color: #1177bb; transform: translateY(-2px); opacity: 1; }
.item-detail-buy-btn:active { transform: translateY(1px); }

/* Shop Sell Tab */
#sell-tab-content { width: 100%; flex: 1; display: flex; /* Active state set by .tab-content.active */ }
.sell-section { display: flex; flex-direction: column; gap: 15px; width: 100%; height: 100%; }
.sell-instructions { color: #e0e0e0; font-size: 1.1em; }
.sell-filter-container { /* No specific styles, may not be needed */ }
.sell-filter { /* Dropdown for filtering sellable items */
    background-color: #333; color: #fff; border: 1px solid #555; border-radius: 4px;
    padding: 8px 12px; width: 100%;
}
.sell-inventory-grid { /* List of items player can sell */
    display: flex; flex-direction: column; gap: 12px; flex-grow: 1;
    min-height: 200px; overflow-y: auto; padding: 15px;
    background-color: rgba(0, 0, 0, 0.2); border-radius: 5px; border: 1px solid #3f3f46;
}
/* Sell Items Container */
.sell-items {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
    gap: 10px;
    padding: 15px 0;
}

.sell-item { /* Individual sellable item card */
    background: linear-gradient(135deg, #2d2d30 0%, #383842 100%);
    border: 2px solid #444;
    border-radius: 8px;
    padding: 10px;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
    position: relative;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.sell-item:hover {
    background: linear-gradient(135deg, #3a3a44 0%, #44444e 100%);
    border-color: #ffd700;
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(255, 215, 0, 0.15);
    opacity: 1;
}

.sell-item .item-icon {
    width: 50px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px; /* Adjusted from 1.8em, relative units can be tricky here */
    margin-bottom: 8px;
    border-radius: 6px;
    padding: 6px;
    overflow: hidden;
    white-space: nowrap; /* Prevents text like emojis from wrapping */
}


.sell-item .item-icon img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.sell-item .item-icon .sell-item-icon { /* For cases where class is on span inside */
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}


.sell-item .item-info {
    flex: 1;
    margin-bottom: 8px;
}

.sell-item .item-name {
    font-size: 0.9em;
    font-weight: bold;
    margin-bottom: 4px;
    color: #e0e0e0;
}

.sell-item .item-quantity {
    font-size: 0.75em;
    color: #aaa;
    margin-bottom: 3px;
}

.sell-item .item-price {
    font-size: 0.8em;
    color: #ffd700;
    font-weight: bold;
    margin-bottom: 6px;
}

.sell-item .sell-button,
.sell-item .sell-all-button {
    background: linear-gradient(90deg, #0e639c 0%, #1177bb 100%);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 0.75em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-bottom: 4px;
}

.sell-item .sell-button:hover,
.sell-item .sell-all-button:hover {
    background: linear-gradient(90deg, #1177bb 0%, #0e639c 100%);
    transform: translateY(-1px);
    box-shadow: 0 3px 8px rgba(17, 119, 187, 0.3);
    opacity: 1;
}

.sell-item .sell-all-button {
    background: linear-gradient(90deg, #28a745 0%, #34ce57 100%);
}

.sell-item .sell-all-button:hover {
    background: linear-gradient(90deg, #34ce57 0%, #28a745 100%);
    box-shadow: 0 3px 8px rgba(40, 167, 69, 0.3);
}
.sell-summary {
    display: flex; justify-content: space-between; align-items: center;
    background-color: rgba(0, 0, 0, 0.2); border-radius: 5px; padding: 15px; margin-top: 10px;
}
.sell-selection-summary { display: flex; flex-direction: column; gap: 5px; }
.sell-actions { display: flex; gap: 10px; }
.sell-button { /* Sell Selected, Sell All buttons */
    background-color: #0e639c; color: white; border: none; border-radius: 4px;
    padding: 8px 15px; transition: background-color 0.2s;
}
.sell-button:hover:not(:disabled) { background-color: #1177bb; opacity: 1; }
.sell-button:disabled { background-color: #555; cursor: not-allowed; opacity: 0.7; }
.sell-inventory-grid::-webkit-scrollbar { width: 8px; }
.sell-inventory-grid::-webkit-scrollbar-track { background: #1a1a1a; border-radius: 4px; }
.sell-inventory-grid::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
.sell-inventory-grid::-webkit-scrollbar-thumb:hover { background: #555; }

/* Shop Categories (if used for Buy tab) */
.shop-categories {
    flex-wrap: wrap; flex-direction: row; max-height: 450px; overflow: auto;
    padding: 1px; margin: 1px; border: 1px solid #3f3f46; border-radius: 5px;
    display:flex; /* Adjusted from 0px */
}
.shop-category-button {
    padding: 10px; margin: 5px; border: 1px solid #3f3f46; border-radius: 5px;
    color: #fff; background-color: #2d2d30; display: block; /* Make buttons take full width */
    text-align: left; /* Align text to left */
}
.shop-category-button:hover { background-color: #3e3e42; transform: translateY(-2px); opacity: 1;}
.shop-category-button.active {
    background-color: #0e639c;
    border-color: #1177bb;
}


/* Transaction Log (Shop purchases) */
.transaction-log {
    position: fixed; bottom: 20px; right: 20px; max-width: 350px; z-index: 1000;
}
.transaction-message {
    background-color: rgba(42, 42, 46, 0.95); color: white; padding: 12px 20px;
    margin-top: 10px; border-radius: 5px; box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: translateX(120%); transition: transform 0.3s ease;
    border-left: 4px solid #0e639c; /* Blue accent */
}
.transaction-message.show { transform: translateX(0); }


/* === Perk Tree Section === */
#perk-tree-section {
  background: linear-gradient(135deg, #181a1b 0%, #23272f 100%);
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 24px rgba(0,0,0,0.3);
}
.perk-system-container {
  /* ... existing layout properties ... */
  background: linear-gradient(135deg, #23272f 0%, #2e3542 100%);
  border-radius: 8px;
  padding: 20px;
  /* Inner glow and outer shadow */
  box-shadow:
    inset 0 0 12px rgba(30,196,105,0.4), /* inner teal glow */
    0 4px 16px rgba(0,0,0,0.3);
  /* Gradient border around container */
  border: 2px solid transparent;
  border-image: linear-gradient(135deg, #1ec469 0%, #00bfff 100%) 1;
}
.perk-points-display {
  background-color: #2c2c2c;
  padding: 18px 20px;
  margin-bottom: 20px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  border-left: 4px solid #1ec469;
}
.perk-points-value {
  color: #1ec469;
}
#perk-tree-section .section-title-text {
  color: #1ec469 !important;
}
.perk-cost-display:hover {
  border-color: #1ec469;
}
.perk-status-action button {
  background-color: #1ec469;
}
.perk-status-action button:hover {
  background-color: #23d977;
}
.perk-points-label { font-size: 1.1em; margin-right: 10px; }
.perk-points-help { margin-left: auto; position: relative; display: inline-block; }
.help-icon {
    cursor: pointer; display: inline-block; width: 20px; height: 20px;
    text-align: center; line-height: 20px; border-radius: 50%; background-color: #555;
}
.perk-points-help .tooltip-content { /* Tooltip for help icon */
    display: none; position: absolute; bottom: 25px; right: 0; width: 250px;
    background-color: #333; padding: 10px; border-radius: 4px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); z-index: 100;
}
.help-icon:hover + .tooltip-content { display: block; } /* Show tooltip on hover */
#perk-list-target, .perk-list { /* Container for perk cards */
    display: grid; gap: 15px;
}
.perk-item-card {
    background-color: #1e1e1e; border: 1px solid #444; border-radius: 4px; padding: 15px;
    transition: all 0.3s ease;
}
.perk-item-card:hover:not(.disabled-perk-card):not(.activated-perk-card) {
    transform: translateY(-3px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); opacity: 1;
}
.perk-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
.perk-name { font-weight: bold; font-size: 1.1em; }
.perk-cost-display {
    background-color: #2c2c2c; color: #fff; border: 1.5px solid #3f3f46;
    border-radius: 4px; font-size: 0.95em; padding: 2px 10px;
    transition: background 0.2s, border-color 0.2s, color 0.2s; display: inline-block;
}
.perk-cost-display:hover {
    background-color: #1976d2; border-color: #1565c0; color: #e3f2fd; opacity: 1;
}
.perk-cost-have { font-weight: bold; margin-left: 4px; }
.perk-cost-have.have-enough { color: #4caf50; }
.perk-cost-have.have-not-enough { color: #f44336; }
.perk-description { color: #ccc; margin-bottom: 15px; font-size: 0.9em; line-height: 1.4; padding-left: 10px; }
.perk-description ul { padding-left: 20px; margin-left: 0; }
.perk-status-action { text-align: right; }
.perk-status-action button { /* Perk activate button */
    background-color: #9c27b0; color: white; border: none;
    /* Inherits button base styles, then specific color */
    padding: 8px 15px; border-radius: 4px;
}
.perk-status-action button:hover { background-color: #b030c0; opacity: 1; }
.activated-perk-card { border-color: #2e7d32; background-color: rgba(46, 125, 50, 0.1); cursor: default; }
.disabled-perk-card { opacity: 0.7; cursor: not-allowed; }
.status-text { margin: 0; } /* For "Activated", "Locked" text */
.perk-item-card.activated-perk-card:not(.cannot-deactivate) { cursor: pointer; }


/* === Build Structures Section === */
#build-structures-section { /* Uses .section, .section-title-header */ }
#available-structures-to-build-list { /* Uses .resource-list */ gap:15px; }
/* Structure cards likely use .skill-resource or a similar structure */


/* === Guild Hall Section === */
/* Prioritizing "Makeover" styles for Guild Hall */
#guild-hall-section { /* Uses .section base, but content styling is distinct */
    padding: 1rem; /* Override default section padding for custom layout */
}
/* General Section Title for Guild Hall (if not using makeover's) */
/* .guild-hall-section .section-title { ... } */

/* --- Guild Members Makeover --- */
.guild-members-section {
  margin-bottom: 2.5rem; padding: 1.5rem 1rem;
  background: linear-gradient(135deg, #23272f 80%, #2e3542 100%);
  border-radius: 18px; box-shadow: 0 4px 24px 0 rgba(0,0,0,0.18);
}
/* Generic section title (like "Guild Members", "Missions") if needed inside guild hall */
.guild-members-section .section-title,
.missions-section .section-title { /* Makeover title style */
  font-family: 'Cinzel', 'Georgia', serif; font-size: 2rem; color: #ffd700;
  margin-bottom: 1.2rem; letter-spacing: 1px; text-shadow: 0 2px 8px #000a;
  border-bottom: none; /* Override generic .section-title border */ text-align: left;
}

.guild-member-card {
  background: rgba(34, 40, 49, 0.98); border: 2px solid #44485a;
  border-radius: 14px; box-shadow: 0 2px 12px 0 rgba(0,0,0,0.12);
  margin-bottom: 1.5rem; padding: 1.2rem; /* Consistent padding */
  transition: transform 0.15s, box-shadow 0.15s, border-color 0.15s;
  display: flex; flex-direction: column; gap: 0.7rem; position: relative;
}
.guild-member-card:hover {
  transform: translateY(-4px) scale(1.02); box-shadow: 0 8px 32px 0 #0006;
  border-color: #4caf50; opacity: 1;
}
.member-main-content { /* Flex container for stats and controls */
  display: flex; flex-direction: row; align-items: flex-start; /* Align to top */
  justify-content: space-between; /* Pushes controls to the right */
  gap: 1rem; width: 100%;
}
.member-info-panel { /* Contains name, title, stats badges */
  flex-grow: 1;
}
.member-header {
    display: flex; /* Already set */
    flex-direction: row; /* Already set */
    justify-content: space-between; /* Add or change this line */
    align-items: baseline; /* Already set */
  }
.member-name {
  font-family: 'Cinzel', 'Georgia', serif; font-size: 1.4rem; font-weight: bold;
  color: #4caf50; letter-spacing: 1px; text-shadow: 0 1px 4px #000a;
}
.member-title {
  font-family: 'Montserrat', 'Arial', sans-serif; font-size: 1.05rem; font-style: italic;
  color: #bfc9d1; opacity: 0.7; margin-left: 0.7em;
}
.member-stats { /* Primary stats like Level, XP, Task */
  display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 0.5rem; /* Increased from 0.2rem */
}
.member-stat-badge {
  display: inline-flex; align-items: center; font-size: 1.01rem; font-weight: 600;
  border-radius: 8px; padding: 0.15em 0.7em 0.15em 0.5em;
  background: linear-gradient(90deg, #2e3a2e 60%, #3e4e3e 100%);
  color: #aaffaa; box-shadow: 0 1px 4px #0002; border: 1.5px solid #3a5a3a; letter-spacing: 0.5px;
}
.member-stat-badge.level { background: linear-gradient(90deg, #ffe066 60%, #ffd700 100%); color: #7a5c00; border-color: #ffe066; text-shadow: 0 1px 2px #fff8; }
.member-stat-badge.xp { background: linear-gradient(90deg, #b0b0ff 60%, #7ecfff 100%); color: #1a3a7a; border-color: #b0b0ff; }
.member-stat-badge.task { background: linear-gradient(90deg, #f7c6ff 60%, #e0aaff 100%); color: #6a217a; border-color: #e0aaff; }

.member-secondary-stats { /* Efficiency, Bonus, etc. */
  display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 0.5rem; /* Increased from 0.2rem */
}
.member-secondary-badge {
  display: inline-flex; align-items: center; font-size: 0.98rem; font-weight: 600;
  border-radius: 8px; padding: 0.13em 0.6em 0.13em 0.4em;
  background: linear-gradient(90deg, #2e3a49 60%, #3e4e5e 100%);
  color: #7ecfff; box-shadow: 0 1px 4px #0002; border: 1.5px solid #3a4a5a; letter-spacing: 0.5px;
}
.member-secondary-badge.bonus { background: linear-gradient(90deg, #ffe066 60%, #ffd700 100%); color: #7a5c00; border-color: #ffe066; text-shadow: 0 1px 2px #fff8; }

.member-controls-wrapper { /* Contains task buttons and finish early */
  display: flex; flex-direction: column; align-items: center; /* Center buttons */
  gap: 0.7rem; min-width: 180px; /* Ensure enough space for buttons */
}
.member-task-buttons {
  display: flex; flex-direction: column; /* Stack task buttons vertically */
  gap: 0.5rem; width: 100%; /* Make button container take width of wrapper */
}
.member-task-buttons .task-btn { /* Styling for Woodcutting, Mining, Hunting buttons */
  font-family: 'Montserrat', 'Arial', sans-serif; font-size: 1.0rem; /* Slightly smaller */
  font-weight: 600; border-radius: 8px; padding: 0.5em 1em; /* Adjusted padding */
  background: linear-gradient(90deg, #23234a 60%, #3e3e7a 100%);
  color: #4caf50; border: 2px solid #4caf50; box-shadow: 0 1px 4px #0003;
  transition: background 0.15s, color 0.15s, border 0.15s;
  width: 100%; /* Make buttons full width of their container */
}
.member-task-buttons .task-btn:hover {
  background: linear-gradient(90deg, #4caf50 60%, #aaffaa 100%);
  color: #23234a; border-color: #23234a; opacity: 1;
}
.member-task-buttons .task-btn.active-member-task {
  background: linear-gradient(90deg, #4caf50 60%, #aaffaa 100%) !important;
  color: #23234a !important; border-color: #23234a !important;
}
/* Task-specific colors (applied if data-task-type is used) */
.member-task-buttons .task-btn[data-task-type="woodcutting"] { color: #4caf50; border-color: #4caf50; }
.member-task-buttons .task-btn[data-task-type="woodcutting"]:hover { background: rgba(76, 175, 80, 0.2); color: #4caf50; border-color: #4caf50; }
.member-task-buttons .task-btn[data-task-type="mining"] { color: #9e9e9e; border-color: #9e9e9e; }
.member-task-buttons .task-btn[data-task-type="mining"]:hover { background: rgba(158, 158, 158, 0.2); color: #9e9e9e; border-color: #9e9e9e; }
.member-task-buttons .task-btn[data-task-type="hunting"] { color: #f44336; border-color: #f44336; }
.member-task-buttons .task-btn[data-task-type="hunting"]:hover { background: rgba(244, 67, 54, 0.2); color: #f44336; border-color: #f44336; }


.member-progress-bar-container { /* Progress bar for current task */
  width: 100%; height: 10px; background-color: #333; border-radius: 6px;
  overflow: hidden; margin: 8px 0 4px;
}
.member-progress-bar-fill {
  height: 100%; background: linear-gradient(90deg, #4caf50 60%, #aaffaa 100%);
  width: 0%; transition: width 0.3s ease; border-radius: inherit;
}
.member-finish-early-container {
  display: flex; justify-content: center; /* Center button if it's the only element */
  padding-top: 10px; margin-top: auto; width: 100%;
}
.finish-early-btn {
  background: linear-gradient(90deg, #c9302c 60%, #e04440 100%);
  color: white; border: 2px solid #e04440; padding: 8px 15px;
  border-radius: 5px; font-weight: 500;
  transition: background 0.2s, border 0.2s, transform 0.1s; width: 100%;
}
.finish-early-btn:hover {
  background: linear-gradient(90deg, #e04440 60%, #c9302c 100%);
  border-color: #c9302c; transform: translateY(-1px); opacity: 1;
}
.finish-early-btn:active { background: #ac2925; border-color: #ac2925; transform: translateY(0); }

/* --- Guild Missions Makeover --- */
.missions-section {
  margin-bottom: 2.5rem; padding: 1.5rem 1rem;
  background: linear-gradient(135deg, #23272f 80%, #2e3542 100%);
  border-radius: 18px; box-shadow: 0 4px 24px 0 rgba(0,0,0,0.18);
}
.mission-card {
  background: rgba(34, 40, 49, 0.98); border: 2px solid #44485a;
  border-radius: 14px; box-shadow: 0 2px 12px 0 rgba(0,0,0,0.12);
  margin-bottom: 1.5rem; padding: 1.2rem 1.5rem; /* Adjusted padding */
  transition: transform 0.15s, box-shadow 0.15s, border-color 0.15s;
  display: flex; flex-direction: column; gap: 0.7rem; position: relative;
}
.mission-card:hover {
  transform: translateY(-4px) scale(1.02); box-shadow: 0 8px 32px 0 #0006;
  border-color: #ffd700; opacity: 1;
}
.mission-header {
  display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.2rem;
}
.mission-title {
  font-family: 'Cinzel', 'Georgia', serif; font-size: 1.5rem; font-weight: bold;
  color: #ffe066; letter-spacing: 1px; text-shadow: 0 1px 4px #000a;
}
.mission-difficulty {
  font-size: 1rem; font-family: 'Montserrat', 'Arial', sans-serif; color: #b0b0ff;
  background: #23234a; border-radius: 8px; padding: 0.2em 0.8em;
  font-weight: 600; box-shadow: 0 1px 4px #0003;
}
.mission-description {
  font-family: 'Montserrat', 'Arial', sans-serif; font-size: 1.08rem; color: #bfc9d1;
  margin-bottom: 0.3rem; margin-top: 0.1rem; line-height: 1.5;
}
.mission-rewards { margin-top: 0.2rem; margin-bottom: 0.2rem; }
.rewards-label { font-size: 1rem; font-weight: 600; color: #ffe066; margin-bottom: 0.1rem; }
.rewards-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.1rem; }
.reward {
  display: inline-flex; align-items: center; font-size: 1.05rem; font-weight: 600;
  border-radius: 8px; padding: 0.18em 0.7em 0.18em 0.5em;
  background: linear-gradient(90deg, #2e3a2e 60%, #3e4e3e 100%);
  color: #aaffaa; box-shadow: 0 1px 4px #0002; border: 1.5px solid #3a5a3a; letter-spacing: 0.5px;
}
.reward.gold-reward { background: linear-gradient(90deg, #ffe066 60%, #ffd700 100%); color: #7a5c00; border-color: #ffe066; text-shadow: 0 1px 2px #fff8; }
.reward.exp-reward { background: linear-gradient(90deg, #b0b0ff 60%, #7ecfff 100%); color: #1a3a7a; border-color: #b0b0ff; }
.reward.item-reward { background: linear-gradient(90deg, #f7c6ff 60%, #e0aaff 100%); color: #6a217a; border-color: #e0aaff; }
.mission-actions { margin-top: 0.5rem; display: flex; gap: 0.7rem; }
.mission-actions button {
  font-family: 'Montserrat', 'Arial', sans-serif; font-size: 1.08rem; font-weight: 600;
  border-radius: 8px; padding: 0.4em 1.2em;
  background: linear-gradient(90deg, #23234a 60%, #3e3e7a 100%);
  color: #ffe066; border: 2px solid #ffe066; box-shadow: 0 1px 4px #0003;
  transition: background 0.15s, color 0.15s, border 0.15s;
}
.mission-actions button:hover {
  background: linear-gradient(90deg, #ffe066 60%, #ffd700 100%);
  color: #23234a; border-color: #23234a; opacity: 1;
}
/* Guild Mission Progress Bar (if any) */
.progress-bar { /* This seems to be a generic progress bar for missions */
    width: 100%; height: 8px; background-color: #333; border-radius: 4px;
    overflow: hidden; margin: 8px 0 4px;
}
.progress-fill { height: 100%; background-color: #2196f3; width: 0%; transition: width 0.3s ease; }

/* --- Guild Hall Tooltips --- */
.member-name.has-tooltip,
.member-secondary-badge.has-tooltip,
.finish-early-btn.has-tooltip {
  position: relative; cursor: help; /* Changed from pointer for tooltips */
}
.member-tooltip {
  display: none; /* Hidden by default, JS will show/hide */
  position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%);
  background: #23272f; color: #ffe066; border-radius: 8px; padding: 10px 16px;
  font-size: 1rem; font-family: 'Montserrat', 'Arial', sans-serif; font-weight: 500;
  box-shadow: 0 4px 16px #000a; border: 2px solid #44485a;
  white-space: pre-line; opacity: 0; pointer-events: none; z-index: 100;
  transition: opacity 0.18s, transform 0.18s; min-width: 180px; max-width: 320px; text-align: center;
}
.member-tooltip.show {
  display: block; opacity: 1; pointer-events: auto; transform: translateX(-50%) translateY(-6px);
}
.member-tooltip::after {
  content: ''; position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
  border-width: 7px; border-style: solid; border-color: #23272f transparent transparent transparent;
}


/* === Farming Section === */
#farming-section { /* Uses .section, .compact-nav */ }
#farm-unlock-status { /* Uses .permit-status */ text-align:center; margin-top:15px; }
.farming-tabs {
    display: flex; gap: 5px; margin-top: 15px; margin-bottom: 15px;
}
.farming-tab {
    flex: 1; padding: 8px 12px; background-color: #444; color: #ddd;
    border: none; text-align: center; border-radius: 4px;
}
.farming-tab:hover { background-color: #555; opacity: 1; }
.farming-tab.active { background-color: #666; color: #fff; }
/* Farming Tab Content (uses .tab-content generic class) */
#overview-content, #animal-management-content, #crop-management-content,
#farm-workers-content, #storage-content {
    background-color: #333;
    padding: 15px;
    border-radius: 5px;
    max-width: 1000px;
    margin: 0 auto;
}
/* Overview Tab */
.overview-nav-buttons { display: flex; gap: 10px; margin-top: 15px; }
.overview-nav-buttons button {
    /* Removed flex:1 so buttons shrink to fit content */ padding: 8px; background-color: #555; color: #fff;
    border: none; border-radius: 4px;
}
.overview-nav-buttons button:hover { background-color: #666; opacity: 1; }
/* Animal Management Tab */
#animal-status-container, #animal-production-container { /* Uses .resource-list */ }
.farm-animal { /* Card for each animal type */
    display: flex; justify-content: space-between; align-items: center;
    padding: 10px; background-color: #444; margin-bottom: 8px; border-radius: 3px;
}
.animal-info { display: flex; align-items: center; }
.animal-emoji { font-size: 24px; margin-right: 10px; }
.animal-details span { display: block; line-height: 1.4; }
.animal-name { font-weight: bold; }
.animal-production { text-align: right; }
/* Crop Management Tab */
#farm-plots-container { /* Uses .resource-list */ margin-top: 15px; gap:15px; }
/* Workers Tab */
#farm-activities-container { /* Uses .resource-list */ margin-top: 20px; }
.farm-worker { /* Card for each worker type */
    display: flex; justify-content: space-between; align-items: center;
    padding: 10px; background-color: #444; margin-bottom: 8px; border-radius: 3px;
}
.worker-info { display: flex; align-items: center; }
.worker-emoji { font-size: 24px; margin-right: 10px; }
.worker-details span { display: block; line-height: 1.4; }
.worker-name { font-weight: bold; }
.worker-skills { display: flex; gap: 10px; }
.worker-skill { padding: 3px 6px; background-color: #555; border-radius: 3px; font-size: 0.8em; }
.worker-actions { display: flex; }
.worker-actions button {
    margin-left: 5px; padding: 5px 8px; background-color: #666;
    border: none; color: white; border-radius: 3px;
}
.worker-actions button:hover { background-color: #777; opacity: 1; }
.worker-card { /* More detailed worker card for hiring/management */
    padding: 10px; background-color: #444; margin-bottom: 10px; border-radius: 5px;
}
.worker-header { display: flex; align-items: center; margin-bottom: 10px; }
.worker-description { margin-bottom: 10px; font-style: italic; color: #ccc; }
.hire-cost, .upkeep-cost { color: #ffcc00; margin-bottom: 5px; }
.worker-assignment { margin-top: 15px; }
.assignment-option {
    display: flex; justify-content: space-between; padding: 8px;
    background-color: #444; margin-bottom: 5px; border-radius: 3px;
}
.empty-notice { /* For empty lists in farming tabs */
    padding: 15px; background-color: #444; color: #ccc;
    font-style: italic; text-align: center; border-radius: 3px;
}
/* Storage Tab */
/* #storage-content uses .tab-content general style */

/* Farming Footer */
#farming-footer-back-btn { /* Uses .btn-back styles */ }


/* === Modal Dialog (e.g. Reset Confirmation) === */
.modal {
    display: none; /* Hidden by default, JS toggles */
    position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%;
    overflow: auto; background-color: rgba(0,0,0,0.8);
    align-items: center; /* For vertical centering */
    justify-content: center; /* For horizontal centering */
}
.modal-content {
    background-color: #2a2a2a; margin: auto; padding: 25px; border: 1px solid #444;
    width: 80%; max-width: 600px; border-radius: 8px; animation-name: animatetop;
    animation-duration: 0.4s;
    position: relative; /* For close button positioning */
}
@keyframes animatetop { from {top: -300px; opacity: 0} to {top: 0; opacity: 1} }
.close-button { /* General modal close button */
    color: #aaa; font-size: 28px; font-weight: bold;
    position: absolute; top: 10px; right: 15px;
}
.close-button:hover, .close-button:focus { color: #fff; text-decoration: none; opacity: 1; }
.modal-buttons { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
.modal-buttons button {
    padding: 10px 15px; border-radius: 4px; border: none;
}
#reset-confirm-yes { background-color: #d9534f; color: white; } /* Red for confirm reset */
#reset-confirm-yes:hover { background-color: #c9302c; opacity: 1; }
#reset-confirm-no { background-color: #5cb85c; color: white; } /* Green for cancel */
#reset-confirm-no:hover { background-color: #4cae4c; opacity: 1; }


/* === Blacksmithing Sections === */
/* Main Blacksmithing Menu */
#blacksmithing-section, /* Old top-level, might be replaced by blacksmithing-menu-section */
#blacksmithing-menu-section { /* Uses .section, .compact-nav or .section-title-header */ }
.blacksmithing-menu-buttons {
    display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;
}
.blacksmithing-button { /* Smelting, Smithing choice buttons */
    flex: 1 1 150px; padding: 10px 12px; text-align: center;
    background-color: #333; color: #fff; border: none; border-radius: 5px;
}
.blacksmithing-button:hover { background-color: #444; opacity: 1; }

/* Smelting Section */
#smelting-section { /* Uses .section, .compact-nav, .resource-list */ }
#smelting-recipes-container { /* Uses .resource-list */ }

/* Smithing Section */
#smithing-section { /* Uses .section, .compact-nav */ }
.smithing-category-tabs { /* Uses .tabs styling */ 
    display: flex; 
    margin-bottom: 15px;
    border-bottom: 1px solid #555
 }
/* .smithing-tab uses .tab base style */
#smithing-recipes-container { /* Uses .resource-list */ }


/* === Actions Menu Section === */
#actions-menu-section { /* Uses .section, .section-title-header (or .compact-nav) */ }
.actions-menu-buttons {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 15px;
}
.action-button { /* Buttons like Combat, Woodcutting, Mining in Actions Menu */
    background-color: #3a3a3e; color: #e0e0e0; border: 1px solid #555;
    border-radius: 5px; padding: 15px; font-size: 1.1em;
    display: flex; flex-direction: column; align-items: center; gap: 8px;
    transition: background-color 0.2s, border-color 0.2s, transform 0.2s;
}
.action-button:hover {
    background-color: #4f4f55; border-color: #777; opacity: 1;
    transform: translateY(-2px);
}
.action-button .button-icon { font-size: 28px; margin-bottom: 5px; }
.action-button .button-label { font-weight: 500; }
/* Specific Action Button Colors (if any different from base) */
#combat-menu-button { /* Example */ }

/* Locked button styling */
.action-button.locked {
    background-color: #2a2a2e !important;
    color: #666 !important;
    border-color: #444 !important;
    cursor: not-allowed !important;
    opacity: 0.6 !important;
    position: relative;
}

.action-button.locked:hover {
    background-color: #2a2a2e !important;
    border-color: #444 !important;
    transform: none !important;
}

.action-button.locked::before {
    content: "🔒";
    position: absolute;
    top: 5px;
    right: 5px;
    font-size: 16px;
    opacity: 0.8;
}


/* === Cooking Section === */
#cooking-section { /* Uses .section, .compact-nav, .permit-status, .resource-list */ }
#available-food-list { /* Uses .resource-list for cookable items */ }
#food-inventory-list { /* Uses .resource-list for food owned, styled like .resource-list */ margin-top: 20px; }


/* === Combat Section === */
#combat-section { /* Uses .section, .section-title-header (or .compact-nav) */ }
#combat-permit-status-display { /* Uses .permit-status */ }
#available-monsters-list { /* Uses .resource-list for monster selection */ }
#available-monsters-list .section-title { /* Title for monster list */
    text-align:left; font-size:1.2em; border:none; padding-bottom:5px; margin-bottom: 10px;
}
/* Combat Arena */
#combat-arena-display {
    /* Initially hidden, shown by JS */
    position: relative; display: flex; flex-direction: column;
    align-items: center; gap: 15px; margin-top: 20px;
}
/* Monster Display in Combat */
#monster-display-combat { /* Container for all monster HP cards */
    display: flex; flex-direction: column; gap: 10px;
    width: 100%; max-width: 550px;
}
.hp-card { /* Individual monster HP card */
    padding: 10px; border-radius: 5px; text-align: center;
    transition: background-color 0.3s ease-in-out, opacity 0.3s, border 0.3s, box-shadow 0.3s;
    border: 1px solid #444; background-color: #383838; /* Default background */
    cursor: pointer; /* To allow targeting */
}
.hp-card .monster-name { /* Div holding name and emoji */
    font-weight: bold; font-size: 1em; line-height: 1.3;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.7); color: #fff; /* Default text color */
}
.hp-card .monster-name .emoji { font-size: 1.2em; margin-right: 5px; }
.hp-card.player-current-target {
    box-shadow: 0 0 8px rgba(77, 182, 240, 0.9); /* Light blue glow for target */
    border: 2px solid #4db6ac; /* Teal border for target */
}
.hp-card.defeated-monster {
    opacity: 0.6; background-color: #222 !important; /* Darken defeated monsters */
    border-color: #333; cursor: default;
}
.hidden-combat-opponent { display: none !important; } /* To hide specific monsters if needed */

/* Player HP Display in Combat */
#player-combat-info-container {
    margin-top: 10px; text-align: center; padding: 10px;
    border: 1px solid #383838; border-radius: 5px; background-color: #2c2c2c;
    font-size: 14px; line-height: 1.2; position: relative; /* For floating text */
}
#player-hp-combat-display {
    font-weight: bold; color: #5cb85c; font-size: 14px; margin-left: 4px;
}
/* Floating Combat Text */
@keyframes fadeOutUp {
    0% { opacity: 1; transform: translateY(0) scale(1); }
    70% { opacity: 0.9; transform: translateY(-15px) scale(1.05); }
    100% { opacity: 0; transform: translateY(-30px) scale(0.8); }
}
.combat-text-float {
    position: absolute; pointer-events: none; font-weight: bold; font-size: 1.1em;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.7); animation: fadeOutUp 1.3s ease-out forwards;
    z-index: 150; padding: 2px 5px; border-radius: 3px;
    /* Positioning handled by JS based on target (player/monster) */
}
.combat-text-monster-dmg { color: #fff; /* White for damage to monster */ }
.combat-text-player-dmg { color: #ff4d4d; /* Bright red for damage to player */ }


/* === Game Log === */
#game-log-container {
    position: fixed; bottom: 20px; right: 20px; width: 350px; max-height: 300px;
    background-color: rgba(34, 34, 34, 0.95); border: 1px solid #3f3f46;
    border-radius: 5px; box-shadow: 0 0 10px rgba(0,0,0,0.5); z-index: 1000;
    transition: height 0.3s, box-shadow 0.5s ease; /* Added box-shadow for flash */
    display: flex; flex-direction: column;
}
.game-log-header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px 12px; background-color: #333333;
    border-bottom: 1px solid #3f3f46;
    border-top-left-radius: 5px; border-top-right-radius: 5px;
}
.game-log-title { font-weight: bold; color: #e0e0e0; }
.game-log-controls { display: flex; gap: 8px; }
.game-log-toggle, .game-log-clear {
    background: none; border: none; color: #e0e0e0; font-size: 12px; padding: 0;
}
.game-log-toggle:hover, .game-log-clear:hover { color: #fff; opacity: 1; }
.game-log-content {
    padding: 10px; overflow-y: auto; flex-grow: 1;
    font-size: 0.9em; max-height: calc(300px - 38px); /* Max height minus header */
}
.game-log-entry {
    margin-bottom: 6px; padding-bottom: 6px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    line-height: 1.4; white-space: pre-wrap;
}
.game-log-entry:last-child { margin-bottom: 0; border-bottom: none; }
.game-log-timestamp { color: #a0a0a0; font-size: 0.8em; margin-right: 5px; }
.game-log-emoji { margin-right: 5px; }
/* Collapsed Game Log */
.game-log-collapsed { height: 38px !important; overflow: hidden !important; }
.game-log-collapsed .game-log-content { display: none; }
/* Game Log Flash on new entry */
@keyframes gameLogFlash {
    0% { box-shadow: 0 0 10px rgba(0,0,0,0.5); } /* Existing shadow */
    50% { box-shadow: 0 0 15px rgba(76, 175, 80, 0.8); } /* Green flash */
    100% { box-shadow: 0 0 10px rgba(0,0,0,0.5); }
}
.game-log-flash { animation: gameLogFlash 0.5s ease; }


/* === Button Color Themes === */
/* These can be applied to various buttons like .menu-button, .action-button, etc. */
.btn-woodcutting { background-color: #588f46 !important; } .btn-woodcutting:hover { background-color: #6aab55 !important; }
.btn-mining { background-color: #6c757d !important; } .btn-mining:hover { background-color: #808890 !important; }
.btn-blacksmithing { background-color: #d66f2e !important; } .btn-blacksmithing:hover { background-color: #e8823f !important; }
.btn-combat { background-color: #c9302c !important; } .btn-combat:hover { background-color: #e04440 !important; }
.btn-eat { background-color: #4cae4c !important; } .btn-eat:hover { background-color: #5cb85c !important; }
.btn-cook { background-color: #eea236 !important; } .btn-cook:hover { background-color: #f0ad4e !important; }
.btn-build-structures { background-color: #795548 !important; } .btn-build-structures:hover { background-color: #8d6e63 !important; }
.btn-buy-tools { background-color: #d4af37 !important; } .btn-buy-tools:hover { background-color: #e6c350 !important; }
.btn-sell-items { background-color: #a7b0b9 !important; } .btn-sell-items:hover { background-color: #c1c8cf !important; }
.btn-buy-permits { background-color: #6a0dad !important; color: #fff !important; } .btn-buy-permits:hover { background-color: #832db5 !important; }
.btn-smelt-bars { background-color: #e07a5f !important; } .btn-smelt-bars:hover { background-color: #f28c70 !important; }
.btn-smith-weapons { background-color: #8d6e63 !important; } .btn-smith-weapons:hover { background-color: #a18278 !important; }
/* Guild member task buttons (if using simple color classes instead of makeover's gradients) */
.member-task-button.btn-woodcutting { background-color: #588f46 !important; }
.member-task-button.btn-woodcutting:hover { background-color: #6aab55 !important; }
.member-task-button.btn-mining { background-color: #6c757d !important; }
.member-task-button.btn-mining:hover { background-color: #808890 !important; }
.member-task-button.btn-combat { background-color: #c9302c !important; }
.member-task-button.btn-combat:hover { background-color: #e04440 !important; }


/* === Responsive Adjustments === */
/* Mobile-first adjustments (default state is mobile) */
@media (max-width: 900px) {
    /* Apply these only when NOT in desktop mode OR if they are general adjustments fine for both */
    body:not(.desktop-mode-active) #hud {
        flex-direction: column; align-items: stretch;
    }
    body:not(.desktop-mode-active) .hud-left,
    body:not(.desktop-mode-active) .hud-right {
        width: 100%; gap: 10px;
    }
    body:not(.desktop-mode-active) .hud-right {
        justify-content: space-around; margin-top: 10px;
    }
    body:not(.desktop-mode-active) .skill-stat-container {
        flex-grow: 1;
    }
}

@media (max-width: 768px) {
    body:not(.desktop-mode-active) .shop-grid {
        /* ... */
    }
    body:not(.desktop-mode-active) #shop-items-container.shop-grid { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); }
    body:not(.desktop-mode-active) .sell-section {
        /* ... */
    }
    body:not(.desktop-mode-active) .inventory-header { flex-direction: column; align-items: flex-start; gap: 10px;}
    body:not(.desktop-mode-active) .inventory-controls { width: 100%; justify-content: flex-start; }
    body:not(.desktop-mode-active) #inventory-back-btn { margin-left: 0; margin-top: 10px; }

    .resource-loot-notification { display: none; } /* Generally good for smaller screens */

    /* Guild member card adjustments - might need body:not(.desktop-mode-active) if they conflict */
    .guild-member-card .member-main-content { flex-direction: column; align-items: center; gap: 0.5rem; }
    .guild-member-card .member-controls-wrapper { width: 100%; }
    .guild-member-card .member-task-buttons { width: 100%; }
    .mission-card { padding: 1rem 0.8rem; }
}

@media (max-width: 480px) {
    body:not(.desktop-mode-active) { padding: 10px; font-size: 14px; }
    body:not(.desktop-mode-active) .container { padding: 10px; padding-top: 50px; }
    body:not(.desktop-mode-active) #hud { padding: 10px; }
    body:not(.desktop-mode-active) .hud-left,
    body:not(.desktop-mode-active) .hud-right { flex-direction: column; align-items: stretch; }

    .stat-container { padding: 5px 8px; }
    .skill-stat-container { min-width: auto; margin-bottom: 5px; }
    .skill-xp-bar-container { width: 100%; }
    .menu-buttons, .town-button-grid, .actions-menu-buttons { grid-template-columns: 1fr; }
    .compact-nav { flex-direction: column; align-items: flex-start; }
    .compact-nav-buttons { margin-top: 10px; width: 100%; display: flex; flex-direction: column; }
    .compact-nav-button { width: 100%; text-align: center; }
    .skill-resource, .action-list-item {
        padding: 10px; flex-direction: column; align-items: flex-start; gap: 5px;
    }
    .resource-inventory-count, .action-item-level {
        position: static; margin-top: 5px; margin-left: 0; align-self: flex-start;
    }
    #game-log-container {
        width: calc(100% - 20px); left: 10px; right: 10px; bottom: 10px; max-height: 150px;
    }
    .shop-controls, .tabs { flex-direction: column; width: 100%; }
    .shop-tab-button, .tab, .smithing-tab { width: 100%; text-align: center; margin-bottom: 5px; border-radius: 4px; }
    .shop-tab-button.active-tab, .tab.active, .smithing-tab.active { border-bottom: 1px solid #3f3f46; }
    body:not(.desktop-mode-active) #shop-items-container.shop-grid { grid-template-columns: 1fr; }
    .modal-content { width: 95%; padding: 15px; }
    .perk-list { grid-template-columns: 1fr; }
    .mission-title { font-size: 1.15rem; }
    .member-name { font-size: 1.1rem; }
    .member-tooltip { font-size: 0.95rem; min-width: 120px; padding: 7px 8px; }
}

/* --- Guild Upgrades Makeover --- */
.guild-upgrades-list {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem 1.5rem;
  justify-content: flex-start;
  margin-top: 1.5rem;
}
.guild-upgrade-card {
  background: rgba(34, 40, 49, 0.98);
  border: 2.5px solid #44485a;
  border-radius: 16px;
  box-shadow: 0 2px 16px 0 rgba(0,0,0,0.13);
  padding: 1.3rem 1.7rem;
  margin-bottom: 1.5rem;
  min-width: 320px;
  max-width: 420px;
  flex: 1 1 340px;
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
  position: relative;
  transition: transform 0.15s, box-shadow 0.15s, border-color 0.15s;
}
.guild-upgrade-card:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 8px 32px 0 #0007;
  border-color: #7ecfff;
  opacity: 1;
}
.guild-upgrade-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.7rem;
  margin-bottom: 0.2rem;
}
.guild-upgrade-emoji {
  font-size: 2.1rem;
  margin-right: 0.5rem;
}
.guild-upgrade-title {
  font-family: 'Cinzel', 'Georgia', serif;
  font-size: 1.35rem;
  font-weight: bold;
  color: #ffd700;
  letter-spacing: 1px;
  text-shadow: 0 1px 4px #000a;
  flex: 1 1 auto;
}
.guild-upgrade-level {
  font-size: 1.1rem;
  font-family: 'Montserrat', 'Arial', sans-serif;
  color: #b0b0ff;
  background: #23234a;
  border-radius: 8px;
  padding: 0.2em 0.8em;
  font-weight: 600;
  box-shadow: 0 1px 4px #0003;
}
.guild-upgrade-description {
  font-family: 'Montserrat', 'Arial', sans-serif;
  font-size: 1.08rem;
  color: #bfc9d1;
  margin-bottom: 0.2rem;
  margin-top: 0.1rem;
  line-height: 1.5;
}
.guild-upgrade-effect-current {
  font-size: 1.01rem;
  color: #aaffaa;
  background: linear-gradient(90deg, #2e3a2e 60%, #3e4e3e 100%);
  border-radius: 8px;
  padding: 0.18em 0.7em 0.18em 0.5em;
  margin-bottom: 0.2rem;
  border: 1.5px solid #3a5a3a;
  box-shadow: 0 1px 4px #0002;
}
.guild-upgrade-next {
  margin-top: 0.2rem;
  background: linear-gradient(90deg, #23234a 60%, #3e3e7a 100%);
  border-radius: 8px;
  padding: 0.7em 1em;
  color: #b0b0ff;
  border: 1.5px solid #44485a;
  box-shadow: 0 1px 4px #0002;
  font-size: 1.01rem;
  display: flex;
  flex-direction: column;
  gap: 0.3em;
}
.guild-upgrade-next-level {
  font-weight: bold;
  color: #ffe066;
  font-size: 1.08rem;
}
.guild-upgrade-next-req {
  font-size: 0.98rem;
  color: #ffd700;
}
.guild-upgrade-next-cost {
  font-size: 0.98rem;
  color: #aaffaa;
}
.guild-upgrade-next-effect {
  font-size: 0.98rem;
  color: #b0b0ff;
}
.guild-upgrade-max-level {
  font-size: 1.05rem;
  color: #aaffaa;
  font-weight: bold;
  margin-top: 0.5em;
  text-align: center;
}
.guild-upgrade-purchase-btn {
  margin-top: 0.7em;
  font-family: 'Montserrat', 'Arial', sans-serif;
  font-size: 1.08rem;
  font-weight: 600;
  border-radius: 8px;
  padding: 0.4em 1.2em;
  background: linear-gradient(90deg, #23234a 60%, #3e3e7a 100%);
  color: #ffe066;
  border: 2px solid #ffe066;
  box-shadow: 0 1px 4px #0003;
  transition: background 0.15s, color 0.15s, border 0.15s;
  width: 100%;
}
.guild-upgrade-purchase-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  background: #44485a;
  color: #b0b0ff;
  border-color: #44485a;
}
.guild-upgrade-purchase-btn:not(:disabled):hover {
  background: linear-gradient(90deg, #ffe066 60%, #ffd700 100%);
  color: #23234a;
  border-color: #23234a;
  opacity: 1;
}

/* --- Guild Member Card Buttons --- */
.small-btn {
  font-size: 0.92rem;
  padding: 0.25em 0.7em;
  margin: 0.5em 0 0.2em 0;
  border-radius: 8px;
  background: #23272e;
  color: #ffcb7d;
  border: 1.5px solid #44485a;
  box-shadow: 0 1px 4px 0 rgba(0,0,0,0.10);
  transition: background 0.15s, color 0.15s;
  cursor: pointer;
}
.small-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
.small-btn:hover:not(:disabled) {
  background: #2d313a;
  color: #ffe6b3;
}

.member-stats .small-btn {
  display: block;
  width: 65%;
  margin-top: 0.5em;
  margin-left: 0;
  margin-right: 0;
}

/* --- Monster HP Bar Styles (Combat) --- */
.monster-hp-bar-container {
  position: relative;
  background: #23234a;
  border-radius: 8px;
  height: 24px; /* Increased from 22px by ~10% */
  margin: 6px 0 8px 0;
  box-shadow: 0 1px 4px #0003;
  overflow: hidden;
  display: flex;
  align-items: center;
}

.monster-hp-bar-fill {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  background: linear-gradient(90deg, #ff4d4d 60%, #ffd700 100%);
  border-radius: 8px 0 0 8px;
  transition: width 0.3s cubic-bezier(.4,2,.6,1);
  z-index: 1;
  width: 100%; /* JS will override this inline */
}

.monster-hp-bar-center-text {
  position: absolute;
  left: 0; top: 0; width: 100%; height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.7em;
  z-index: 2;
  pointer-events: none;
}

.monster-name, /* Applied to span inside .monster-hp-bar-center-text */
.monster-hp-bar-text { /* Applied to span inside .monster-hp-bar-center-text */
  font-size: 1.08em;
  font-weight: bold;
  color: #fff;
  text-shadow: 0 1px 2px #000a;
  letter-spacing: 1px;
}


.floating-text {
  position: fixed;
  pointer-events: none;
  font-weight: bold;
  color: #fff;
  text-shadow: 0 1px 2px #000a;
  z-index: 9999;
  animation: fadeOutUp 1.3s ease-out forwards;
}

@keyframes fadeOutUp {
  0% { opacity: 1; transform: translateY(0) scale(1); }
  70% { opacity: 0.9; transform: translateY(-15px) scale(1.05); }
  100% { opacity: 0; transform: translateY(-30px) scale(0.8); }
}

.floating-text.crit {
  color: #ff3333;
  font-size: 1.5em !important;
  font-weight: bold;
  text-shadow: 0 0 8px #ffd700, 0 1px 2px #000a;
  animation: critPop 0.3s cubic-bezier(.4,2,.6,1) 0s 1, fadeOutUp 1.3s ease-out forwards;
}

@keyframes critPop {
  0% { transform: scale(1.5) translateY(0); }
  80% { transform: scale(1.1) translateY(-10px); }
  100% { transform: scale(1) translateY(-15px); }
}

.floating-text.fade-center {
  animation: fadeOutUp 1.3s ease-out forwards;
}
.floating-text.fade-left {
  animation: fadeOutUpLeft 1.3s ease-out forwards;
}
.floating-text.fade-right {
  animation: fadeOutUpRight 1.3s ease-out forwards;
}

@keyframes fadeOutUp {
  0% { opacity: 1; transform: translateY(0) scale(1); }
  70% { opacity: 0.9; transform: translateY(-15px) scale(1.05); }
  100% { opacity: 0; transform: translateY(-30px) scale(0.8); }
}
@keyframes fadeOutUpLeft {
  0% { opacity: 1; transform: translateY(0) scale(1); }
  70% { opacity: 0.9; transform: translate(-20px, -15px) scale(1.05); }
  100% { opacity: 0; transform: translate(-40px, -30px) scale(0.8); }
}
@keyframes fadeOutUpRight {
  0% { opacity: 1; transform: translateY(0) scale(1); }
  70% { opacity: 0.9; transform: translate(20px, -15px) scale(1.05); }
  100% { opacity: 0; transform: translate(40px, -30px) scale(0.8); }
}

/* === Clickable Enchantment Containers === */
.enchantment-container {
    cursor: pointer;
    transition: background-color 0.2s, transform 0.3s ease, border 0.3s ease;
    border: 1px solid transparent;
    border-radius: 4px;
    padding: 6px 8px;
    margin: 2px 0;
    position: relative;
}

.enchantment-container:hover {
    background-color: rgba(255, 255, 255, 0.1);
    transform: scale(1.02);
    border-radius: 6px;
}

/* Tier-specific hover effects */
.enchantment-container.tier-common-stat:hover {
    border: 1px solid #9e9e9e;
    background-color: rgba(158, 158, 158, 0.15);
}

.enchantment-container.tier-uncommon-stat:hover {
    border: 1px solid #4caf50;
    background-color: rgba(76, 175, 80, 0.15);
}

.enchantment-container.tier-rare-stat:hover {
    border: 1px solid #2196f3;
    background-color: rgba(33, 150, 243, 0.15);
}

.enchantment-container.tier-epic-stat:hover {
    border: 1px solid #9c27b0;
    background-color: rgba(156, 39, 176, 0.15);
}

.enchantment-container.tier-legendary-stat:hover {
    border: 1px solid #ff9800;
    background-color: rgba(255, 152, 0, 0.15);
}

/* Locked enchantment styling */
.enchantment-container.locked {
    border-left: 3px solid #ffd700;
    background-color: rgba(255, 215, 0, 0.1);
}

.enchantment-container.locked::after {
    content: "";
    position: absolute;
    top: 2px;
    right: 4px;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: #ffd700;
    box-shadow: 0 0 4px rgba(255, 215, 0, 0.6);
}

/* Modernized mining-resource (used for smelting/smithing) */
.mining-resource {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
  padding: 12px 18px;
  margin: 8px 0;
  border-radius: 12px;
  background: linear-gradient(90deg, #232323 60%, #292929 100%);
  border: 1.5px solid #333;
  min-height: 48px;
  font-size: 1.08em;
  box-shadow: 0 2px 8px #0003;
  transition: background 0.22s, box-shadow 0.22s, border-color 0.22s, transform 0.18s;
  cursor: pointer;
}

/* Smaller containers specifically for 2-handed swords in smithing */
.mining-resource[data-weapon-type="2h-sword"] {
  padding: 8px 12px;
  margin: 4px 0;
  min-height: 36px;
  font-size: 0.95em;
  gap: 10px;
  max-height: fit-content;
  
}

.mining-resource[data-weapon-type="2h-sword"] .resource-icon {
  font-size: 1em; /* Was 'em' which is invalid, defaulting to 1em */
  margin-right: 8px;
}

.mining-resource:hover:not(.greyed-out) {
  background: linear-gradient(90deg, #2d2d2d 60%, #353535 100%);
  border-color: #ffe066;
  box-shadow: 0 4px 18px #ffe06644, 0 2px 12px #0005;
  transform: scale(1.035);
  z-index: 3;
}
.mining-resource.greyed-out {
  opacity: 0.55;
  filter: grayscale(0.7);
  cursor: not-allowed;
}
.active-resource {
  box-shadow: 0 0 0 3px #ffe066, 0 2px 16px #ffe06633, 0 2px 12px #0006;
  background: linear-gradient(90deg, #35351a 60%, #49491a 100%) !important;
  border-color: #ffe066 !important;
  z-index: 4;
}
.resource-icon {
  font-size: 2.1em;
  margin-right: 12px;
  flex-shrink: 0;
  filter: drop-shadow(0 1px 2px #0008);
}
.resource-name {
  font-weight: 700;
  font-size: 1.13em;
  margin-right: 10px;
  letter-spacing: 0.01em;
}
.resource-details {
  font-size: 0.98em;
  color: #bdbdbd;
  flex: 1;
  margin-right: 18px;
}
.resource-divider {
  width: 1.5px;
  height: 32px;
  background: linear-gradient(to bottom, #ffe06644 0%, #ffe06600 100%);
  margin: 0 12px;
  border-radius: 2px;
  align-self: center;
}
.resource-inventory-count, .resource-max-craft {
  font-size: 1.08em;
  font-weight: 600;
  color: #ffe066;
  margin-left: 8px;
  min-width: 36px;
  text-align: right;
}
.resource-max-craft {
  color: #aaffaa;
}
.static-gain-text {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  color: #aaffaa;
  font-weight: bold;
  background: rgba(30,40,30,0.92);
  border-radius: 8px;
  padding: 4px 16px;
  z-index: 10;
  font-size: 1.13em;
  pointer-events: none;
  box-shadow: 0 1px 8px #0007;
  opacity: 0;
  animation: staticGainFade 1.7s forwards;
}

@keyframes staticGainFade {
  0% { opacity: 0; }
  12% { opacity: 1; }
  88% { opacity: 1; }
  100% { opacity: 0; }
}

.static-gain-text.right {
  left: 75%;
  transform: translate(-50%, -50%);
}

.static-gain-text.small {
  font-size: 0.95em;
  padding: 2px 10px;
  border-radius: 6px;
}

.compact-details {
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.resource-recipe {
  color: #4ec9b0;
  font-size: 0.98em;
  font-weight: 500;
  margin-top: 1px;
}
.resource-ingredient {
  margin-right: 6px;
  display: inline-flex;
  align-items: center;
}
.resource-ingredient-name {
  font-weight: 600;
  color: #bdbdbd;
  margin-left: 2px;
}
.resource-xp {
  color: #ffe066;
  font-weight: 600;
  margin-left: 8px;
  font-size: 0.97em;
}

/* === Blacksmithing Modern Menu Styles === */
.blacksmithing-menu-modern {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 60vh;
}
.blacksmithing-menu-card {
    background: linear-gradient(135deg, #232526 0%, #414345 100%);
    box-shadow: 0 6px 32px 0 rgba(0,0,0,0.35), 0 1.5px 4px 0 rgba(255, 196, 81, 0.08);
    border-radius: 18px;
    max-width: 420px;
    width: 100%;
    margin: 0 auto;
    padding: 36px 32px 64px 32px;
    display: flex;
    flex-direction: column;
    align-items: center;
    border: 1.5px solid #ffb74d33;
    position: relative;
}
.blacksmithing-menu-icon {
    font-size: 3.2em;
    margin-bottom: 10px;
    filter: drop-shadow(0 0 12px #ffb74d88);
    animation: blacksmithingGlow 3s infinite alternate;
}
.blacksmithing-menu-title {
    font-size: 2.1em;
    font-weight: 800;
    letter-spacing: 1px;
    margin-bottom: 4px;
    text-shadow: 0 2px 8px #000a;
}
.blacksmithing-menu-subtitle {
    color: #d4d4d4cc;
    font-size: 1.1em;
    margin-bottom: 28px;
    font-weight: 500;
    text-align: center;
}
.blacksmithing-menu-buttons-modern {
    display: flex;
    gap: 22px;
    justify-content: center;
    margin-bottom: 24px;
    flex-wrap: wrap;
}
.blacksmithing-button-modern {
    display: flex;
    align-items: center;
    font-size: 1.25em;
    font-weight: 700;
    padding: 18px 36px;
    border: none;
    border-radius: 12px;
    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.18);
    cursor: pointer;
    transition: background 0.18s, transform 0.18s, box-shadow 0.18s;
    margin: 0 0 0 0;
    outline: none;
    color: #fff;
    letter-spacing: 0.5px;
    background: linear-gradient(90deg, #ff9800 0%, #ff5722 100%);
}
.blacksmithing-button-modern .blacksmithing-btn-icon {
    font-size: 1.5em;
    margin-right: 12px;
    filter: drop-shadow(0 0 4px #fff3);
}
.blacksmithing-button-modern:active {
    transform: scale(0.97);
}
.blacksmithing-button-modern:hover {
    filter: brightness(1.08);
    box-shadow: 0 4px 18px 0 rgba(255, 152, 0, 0.18);
    opacity: 0.97;
}
.smelt-btn {
    background: linear-gradient(90deg, #ff7043 0%, #ffb74d 100%);
    box-shadow: 0 2px 12px 0 rgba(255, 112, 67, 0.18);
    position: relative;
    overflow: visible;
}

/* CSS Fire Effect for Smelting Button */
.smelt-btn .blacksmithing-btn-icon {
    display: inline-block;
    position: relative;
    width: 50px;
    height: 50px;
    margin-right: 8px;
}

/* Base flame layers */
.smelt-btn .blacksmithing-btn-icon::before {
    content: '';
    position: absolute;
    bottom: 0;
    border-bottom-right-radius: 50%;
    border-bottom-left-radius: 50%;
    border-top-left-radius: 50%;
    transform: rotate(-45deg) scale(1.5, 1.5);
    animation: flicker 2s ease-in-out infinite;
}

.smelt-btn .blacksmithing-btn-icon::after {
    content: '';
    position: absolute;
    bottom: 0;
    border-bottom-right-radius: 50%;
    border-bottom-left-radius: 50%;
    border-top-left-radius: 50%;
    transform: rotate(-45deg) scale(1.5, 1.5);
}

/* Red outer flame */
.smelt-btn .blacksmithing-btn-icon::before {
    left: 5px;
    width: 30px;
    height: 30px;
    background: orangered;
    box-shadow: 0px 0px 5px 4px orangered;
    z-index: 1;
}

/* Orange middle flame */
.smelt-btn .blacksmithing-btn-icon::after {
    left: 8px;
    width: 24px;
    height: 24px;
    background-color: orange;
    box-shadow: 0px 0px 9px 4px orange;
    z-index: 2;
    animation-delay: 0.2s;
}

/* Yellow inner flame - using span */
.smelt-btn .blacksmithing-btn-icon {
    transform-origin: center bottom;
}

.smelt-btn .blacksmithing-btn-icon span {
    position: absolute;
    bottom: 0;
    left: 11px;
    width: 18px;
    height: 18px;
    background: gold;
    box-shadow: 0px 0px 9px 4px gold;
    border-bottom-right-radius: 50%;
    border-bottom-left-radius: 50%;
    border-top-left-radius: 50%;
    transform: rotate(-45deg) scale(1.5, 1.5);
    z-index: 3;
    animation: flicker 2s ease-in-out infinite;
    animation-delay: 0.4s;
}

/* White core */
.smelt-btn .blacksmithing-btn-icon span::before {
    content: '';
    position: absolute;
    left: 3px;
    bottom: -2px;
    width: 12px;
    height: 12px;
    background: white;
    box-shadow: 0px 0px 9px 4px white;
    border-bottom-right-radius: 50%;
    border-bottom-left-radius: 50%;
    border-top-left-radius: 50%;
    transform: rotate(0deg) scale(0.8, 0.8);
    z-index: 4;
}

@keyframes flicker {
    0% { transform: rotate(-45deg) scale(1.5, 1.5); }
    20% { transform: rotate(-43deg) scale(1.5, 1.5); }
    40% { transform: rotate(-45deg) scale(1.5, 1.5); }
    60% { transform: rotate(-43deg) scaleY(1.54) scaleX(1.5); }
    80% { transform: rotate(-48deg) scaleY(1.42) scaleX(1.5); }
    100% { transform: rotate(-45deg) scale(1.5, 1.5); }
}

/* Hover effect */
.smelt-btn:hover .blacksmithing-btn-icon::before,
.smelt-btn:hover .blacksmithing-btn-icon::after,
.smelt-btn:hover .blacksmithing-btn-icon span {
    animation-duration: 1.5s;
    filter: brightness(1.1);
}
.smith-btn {
    background: linear-gradient(90deg, #ffd54f 0%, #b8860b 100%);
    color: #3e2723;
    box-shadow: 0 2px 12px 0 rgba(255, 213, 79, 0.18);
}
.blacksmithing-menu-footer-controls {
    display: flex;
    gap: 14px;
    justify-content: center;
    margin-top: 18px;
    width: 100%;
}
.blacksmithing-back-btn {
    background: linear-gradient(90deg, #232526 0%, #414345 100%);
    color: #ffd54f;
    border: none;
    border-radius: 8px;
    font-size: 1em;
    font-weight: 600;
    padding: 10px 22px;
    box-shadow: 0 1px 6px 0 rgba(0,0,0,0.18);
    transition: background 0.18s, color 0.18s, box-shadow 0.18s;
}
.blacksmithing-back-btn:hover {
    background: linear-gradient(90deg, #414345 0%, #232526 100%);
    color: #fffde4;
    box-shadow: 0 2px 10px 0 rgba(255, 213, 79, 0.12);
}
@media (max-width: 600px) {
    .blacksmithing-menu-card {
        padding: 18px 6vw 16px 6vw;
        max-width: 98vw;
    }
    .blacksmithing-menu-buttons-modern {
        flex-direction: column;
        gap: 14px;
    }
    .blacksmithing-button-modern {
        width: 100%;
        justify-content: center;
        font-size: 1.1em;
        padding: 14px 0;
    }
}

.blacksmithing-menu-header-row {
    width: 100%;
    display: flex;
    justify-content: flex-end;
    align-items: flex-start;
    margin-bottom: 8px;
    min-height: 36px;
}
.blacksmithing-menu-header-row .blacksmithing-back-btn {
    margin-top: 0;
    margin-right: 0;
    margin-bottom: 0;
    /* Already styled as a card button */
}
.blacksmithing-back-btn-topright {
    position: absolute;
    top: 18px;
    right: 22px;
    z-index: 2;
}
.blacksmithing-back-btn-bottomleft {
    position: absolute;
    bottom: 18px;
    left: 22px;
    z-index: 2;
}

/* === Character Info Modern Styles === */
.character-info-card {
  background: linear-gradient(135deg, #232526 0%, #414345 100%);
  box-shadow: 0 8px 32px 0 rgba(0,0,0,0.35), 0 2px 8px 0 rgba(255, 196, 81, 0.08);
  border-radius: 22px;
  width: 100%;
  margin: 0;
  padding: 0 0 32px 0;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border: 2px solid #ffb74d33;
}
.card-internal-wrapper {
  display: flex;
  flex-direction: row;
  gap: 5px;
  width: 100%;
  justify-content: stretch;
  align-items: flex-start;
  margin-top: 8px;
}
.card-left-column {
  flex: 1.3 1 0;
  display: flex;
  flex-direction: column;
  gap: 0;
  min-width: 0;
}
.card-right-column {
    flex: auto;
    display: flex;
    flex-direction: column;
    min-width: 320px;
    max-width: 840px;
    margin-left: auto;
}
@media (max-width: 900px) {
  .card-internal-wrapper {
    flex-direction: column;
    gap: 0;
  }
  .card-right-column {
    max-width: 100%;
    margin-left: 0;
    min-width: 0;
  }
  .equipment-section-grid {
    grid-template-columns: 1fr 1fr 1fr;
    grid-template-rows: 1fr 1fr;
  }
}
@media (max-width: 600px) {
  .equipment-section-grid {
    grid-template-columns: 1fr;
    grid-template-rows: none;
  }
}
.character-section-header {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  padding: 10px 0 6px 0;
  border-bottom: 1.5px solid #444;
  background: linear-gradient(90deg, #232526 60%, #2d2d2d 100%);
  border-top-left-radius: 22px;
  border-top-right-radius: 22px;
  width: 100%;
  min-height: unset;
}
.character-header-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  gap: 0;
}
.character-header-title {
  font-size: 1.3em;
  font-weight: 700;
  color: #90cdf4;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 10px;
}
.character-header-emoji {
  font-size: 1.5em;
  margin-right: 8px;
}
.btn-back-header {
  font-size: 1.3em;
  margin-left: 18px;
  background: none;
  border: none;
  color: #e0e0e0;
  cursor: pointer;
  padding: 0 8px;
  border-radius: 4px;
  transition: background 0.18s, color 0.18s;
}
.btn-back-header:hover {
  background: #333;
  color: #fff;
}
.character-section-card {
  background: rgba(40, 40, 48, 0.98);
  border-radius: 16px;
  box-shadow: 0 2px 12px 0 rgba(0,0,0,0.18);
  border: 2px solid #ffb74d33;
  margin: 2px;
  padding: 2px;
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.character-section-title {
  display: flex;
  align-items: center;
  font-weight: 600;
  font-size: 1.15em;
  margin-bottom: 2px;
  color: #ffd166;
  letter-spacing: 0.01em;
}
.character-section-icon {
  font-size: 1.25em;
  margin-right: 10px;
}
.character-section-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px 18px;
  margin-bottom: 0;
}
.equipment-section-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(2, 1fr);
  width: 100%;
  gap: 12px 12px;
}
.skill-levels-section-grid {
  grid-template-columns: 1fr;
  gap: 8px 0;
}
.character-section-total-xp {
  font-size: 0.98em;
  color: #b388ff;
  margin-left: 18px;
  font-weight: 400;
}
.character-skill-speed-overview {
  background: linear-gradient(90deg, #232526 60%, #2d2d2d 100%);
  border-radius: 10px;
  padding: 2px 4px;
  color: #e0e0e0;
  font-size: 1.05em;
  box-shadow: 0 1px 4px 0 rgba(0,0,0,0.10);
  margin-left: 0;
}
@media (max-width: 700px) {
  .character-info-card {
    max-width: 98vw;
    margin: 12px auto 12px auto;
    padding: 0 0 16px 0;
  }
  .character-section-card {
    margin: 14px 4px 0 4px;
    padding: 12px 6px 10px 6px;
  }
  .character-section-grid, .equipment-section-grid {
    grid-template-columns: 1fr;
    gap: 8px 0;
  }
}
/* Ensure stat-row, compact-skill-row, etc. remain compatible */
.stat-row, .compact-skill-row {
  background: none;
  border: none;
  box-shadow: none;
  margin: 0;
  padding: 0 0 0 0;
  font-size: 1em;
}

.equipment-section-grid .equip-btn, 
.equipment-section-grid button[id^="equip-"] {
    background: linear-gradient(90deg, #2196f3 60%, #21cbf3 100%);
    color: #fff;
    font-weight: bold;
    border: none;
    border-radius: 22px;
    box-shadow: 0 2px 8px 0 rgba(33, 150, 243, 0.18);
    padding: 8px 18px;
    margin-top: 8px;
    font-size: 0.8em;
    cursor: pointer;
    transition: background 0.18s, box-shadow 0.18s, transform 0.12s;
    outline: none;
    letter-spacing: 0.02em;
    z-index: 1;
}
.equipment-section-grid .equip-btn:hover, 
.equipment-section-grid button[id^="equip-"]:hover {
  background: linear-gradient(90deg, #21cbf3 60%, #2196f3 100%);
  box-shadow: 0 4px 16px 0 rgba(33, 150, 243, 0.28);
  transform: scale(1.06);
  filter: brightness(1.08);
}

.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0,0,0,0.45);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}
.modal-overlay.hidden {
  display: none !important;
}
.modal-dialog {
  background: #232526;
  border-radius: 18px;
  box-shadow: 0 8px 32px 0 rgba(0,0,0,0.35), 0 2px 8px 0 rgba(255, 196, 81, 0.08);
  padding: 20px;
  min-width: 650px;
  max-width: 1200px;
  min-height: 500px;
  max-height: 80vh;
  overflow-y: auto;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 900px) {
  .modal-dialog {
    min-width: 98vw;
    max-width: 98vw;
    min-height: 0;
    max-height: 90vh;
    padding: 12px 2vw 10px 2vw;
  }
}
.modal-close-btn {
  position: absolute;
  top: 12px;
  right: 16px;
  background: none;
  border: none;
  font-size: 1.8em;
  color: #aaa;
  cursor: pointer;
  transition: color 0.15s;
  z-index: 1;
}
.modal-close-btn:hover {
  color: #fff;
}
#cancel-equip-btn {
  margin-top: 18px;
  background: linear-gradient(90deg, #555 60%, #888 100%);
  color: #fff;
  border: none;
  border-radius: 12px;
  padding: 10px 22px;
  font-size: 1.08em;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.15s;
}
#cancel-equip-btn:hover {
  background: linear-gradient(90deg, #888 60%, #555 100%);
}
.modal-dialog .inventory-item {
  font-size: 0.9em;
  padding: 8px;
  min-width: 85px;
  min-height: 140px;
  box-shadow: 0 2px 8px 0 rgba(33, 150, 243, 0.10);
  border-radius: 8px;
  border: 2.5px solid transparent;
  transition: border-color 0.18s, box-shadow 0.18s, background 0.18s;
  display: flex;
  flex-direction: column;
}
.modal-dialog .inventory-item .item-icon {
  font-size: 1.8em;
}
.modal-dialog .inventory-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  max-height: 500px;
  overflow-y: auto;
}

/* --- Modal dialog should shrink to fit content when empty --- */
#item-selection-for-equip-target {
  min-height: 0 !important;
  height: auto !important;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
}

#item-selection-for-equip-target .inventory-grid.empty {
  min-height: 0 !important;
  max-height: none !important;
  height: auto !important;
  padding: 16px 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* --- Perk Tree Mockup Styles (updated for spacing and font size) --- */
.perk-tree-mockup {
  position: relative;
  width: 1100px;
  height: 700px;
  margin: 0 auto;
  /* Animated gradient background */
  background: linear-gradient(135deg, #1ec469, #00bfff, #23272f, #181a1b);
  background-size: 800% 800%;
  animation: gradientBG 12s ease infinite;
  border-radius: 18px;
  box-shadow: 0 4px 24px 0 rgba(0,0,0,0.18);
  overflow: visible;
}
.perk-tree-svg {
  z-index: 1;
}
.perk-node-mockup {
  z-index: 2;
  position: absolute;
  width: 80px;
  height: 80px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: 0.85em;
  color: #fff;
  background: #232526;
  box-shadow: 0 2px 8px #0008;
  transition: box-shadow 0.18s, border 0.18s, background 0.18s;
  border: 3.5px solid #44485a;
  cursor: pointer;
}
.perk-title {
  font-size: 0.85em;
  margin-top: 2px;
  text-align: center;
  font-weight: 500;
}
.perk-tooltip {
  position: absolute;
  min-width: 120px;
  max-width: 220px;
  background: #23272f;
  color: #fff;
  font-size: 0.85em;
  border-radius: 8px;
  box-shadow: 0 2px 8px #000a;
  padding: 8px 12px;
  pointer-events: none;
  z-index: 10;
  text-align: left;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}
.perk-tooltip.active {
  opacity: 0.97;
  visibility: visible;
}
/* Extra SVG lines for diversity */
.perk-tree-svg line {
  transition: stroke 0.18s;
}

/* Center the perk tree horizontally in the window */
.perk-list {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  width: 100%;
}

/* Perk Tree Pyramid Node States */
.perk-node-mockup.locked {
  opacity: 0.45;
  filter: grayscale(1);
  cursor: not-allowed !important;
  background: #232526;
  border-color: #44485a;
}
.perk-node-mockup.unlocked {
  opacity: 1;
  filter: none;
  cursor: pointer;
  background: #232526;
  border-color: #44485a;
  transition: box-shadow 0.18s, border 0.18s, background 0.18s;
}
.perk-node-mockup.unlocked:hover {
  box-shadow: 0 0 12px #1ec46988, 0 2px 8px #0008;
  border-color: #1ec469;
  background: #232f26;
}
.perk-node-mockup.activated {
  opacity: 1;
  filter: none;
  cursor: default !important;
  border-color: #2e7d32;
  background: #2e7d32;
  box-shadow: 0 0 10px 2px #2e7d32aa;
}
.perk-node-mockup.circle {
  border-radius: 50%;
}

.skill-speed-row:hover .custom-tooltip-text { /* This seems to be a duplicate from Character section. Kept for safety. */
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(-12px);
}

/* === Perk Tree Background Animation === */
@keyframes gradientBG {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* === Perk Ripple Effect === */
.perk-tree-mockup { overflow: hidden; }
.perk-ripple {
    position: absolute;
    width: 8px;
    height: 8px;
    background: rgba(30,196,105,0.5);
    border-radius: 50%;
    transform: translate(-50%, -50%) scale(0);
    animation: rippleAnim 1.2s ease-out;
    pointer-events: none;
    z-index: 1;
}
@keyframes rippleAnim {
    to { transform: translate(-50%, -50%) scale(10); opacity: 0; }
}

/* Combat Stats Tooltips */
.stat-row { position: relative; }
.stat-row .custom-tooltip-text {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    bottom: 100%;
    left: 0;
    transform: translateY(-4px);
    background-color: #222; /* Dark container */
    color: #e0e0e0; /* Light text */
    padding: 8px 12px; /* Increased padding */
    border-radius: 6px;
    border: 1px solid #1ec469; /* Accent green border */
    box-shadow: 0 0 8px rgba(30, 196, 105, 0.7);
    max-width: 260px; /* Limit width */
    line-height: 1.4;
    white-space: pre-line; /* Respect line breaks */
    transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
    z-index: 1000;
    pointer-events: none;
}
.stat-row:hover .custom-tooltip-text {
    visibility: visible;
    opacity: 1;
}

/* Tooltip description border styling */
.custom-tooltip-text .tooltip-desc {
    border-bottom: 1px solid #444;
    padding-bottom: 2px;
    margin-bottom: 4px;
}
/* Accent color for sources header in tooltip */
.custom-tooltip-text .tooltip-sources strong {
    color: #1ec469;
}

/* AOE section styling in tooltips */
.custom-tooltip-text .tooltip-aoe {
    border-top: 1px solid #444;
    padding-top: 4px;
    margin-top: 4px;
}
.custom-tooltip-text .tooltip-aoe strong {
    color: #ff9800; /* Orange color for AOE section */
}

/* Character Skill Speed Overview Hover Effects */
.character-skill-speed-overview > div {
    position: relative;
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px solid transparent;
    transition: all 0.3s ease;
    cursor: pointer;
}

.character-skill-speed-overview > div:hover {
    transform: scale(1.05);
    border-radius: 6px;
    background-color: rgba(255, 255, 255, 0.1);
}

/* Skill-specific hover effects for speed overview */
.character-skill-speed-overview > div:first-child:hover {
    border: 1px solid #f44336;
    animation: attackGlow 2s infinite alternate;
    background-color: rgba(244, 67, 54, 0.2);
}

.character-skill-speed-overview > div:nth-child(2):hover {
    border: 1px solid #9e9e9e;
    animation: miningGlow 2s infinite alternate;
    background-color: rgba(158, 158, 158, 0.2);
}

.character-skill-speed-overview > div:nth-child(3):hover {
    border: 1px solid #4caf50;
    animation: woodcuttingGlow 2s infinite alternate;
    background-color: rgba(76, 175, 80, 0.2);
}

/* Farming Overview Map */
#farm-map {
    display: grid;
    grid-template-columns: repeat(4, minmax(120px, 1fr));
    gap: 10px;
    padding: 1px;
    
}
.farm-tile {
    border: 2px dashed #444;
    border-radius: 4px;
    background-color: #222;
    color: #ccc;
    height: 120px;
    position: relative;
    overflow: visible; /* Allow tooltips and animations to extend outside tile */
    cursor: pointer;
    transition: border-color 0.2s;
    min-width: 250px !important;
}
.farm-tile.built {
    border-color: #1ec469;
}
.farm-tile .tile-label {
    position: absolute;
    top: 4px;
    left: 4px;
    transform: none;
    font-size: 0.85em;
    font-weight: bold;
    z-index: 5; /* bring plot title above content */
}
.farm-tile .tile-content {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 240px;
    height: 110px;
    transform: translate(-50%, -50%);
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: none;
}
.tile-animal {
    position: absolute;
    /* Movement offsets & rotation controlled via CSS variables */
    --dx: 4px;
    --dy: -4px;
    --angle: 10deg;
    animation-name: moveAround;
    animation-duration: var(--duration, 3s);
    animation-delay: var(--delay, 0s);
    animation-timing-function: ease-in-out;
    animation-direction: alternate;
    animation-iteration-count: infinite;
}
@keyframes moveAround {
    from { transform: translate(0, 0) rotate(0deg); }
    to   { transform: translate(var(--dx), var(--dy)) rotate(var(--angle)); }
}

/* Responsive: stack farm overview tiles vertically on smaller screens */
@media (max-width: 768px) {
    #farm-map {
        display: flex;
        flex-direction: column;
        align-items: stretch;
    }
    /* Ensure each tile spans full width in mobile view */
    #farm-map .farm-tile {
        width: 100%;
        max-width: none;
    }
}

/* Crop Plot Slot Layout: 8 columns grid for plot emojis */
.plot-slots {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    gap: 4px;
}
.crop-slot-icon, .crop-slot-placeholder {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    font-size: 1.5em;
}

/* Farm Plot Tile Emoji Grid */
.plot-tile .tile-content {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    justify-items: center;
    align-items: center;
    margin-top: 10px;
    max-height: 60px;
}
.plot-tile .tile-content br {
    display: none;
}

/* Center emojis for small crop plots */
.plot-tile[title*="Small Crop Plot"] .tile-content {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 4px;
}

/* Responsive: switch to column layout when too narrow */
@media (max-width: 300px) {
  .plot-tile {  
    min-width: auto !important; /* allow shrinking */
  }
  .plot-tile .tile-content {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
}

/* Farm Worker UI Styles */
#hired-workers-overview {
    padding: 15px;
    background: #222;
    border: 1px solid #4caf50;
    border-radius: 5px;
    display: flex;
    gap: 20px;
}
.hwo-section {
    flex: 1;
    background: #2e7d32;
    border-radius: 4px;
    padding: 10px 15px;
}
.hwo-section h4 {
    margin: 0 0 10px 0;
    color: #ffd700;
    border-bottom: 1px solid #4caf50;
    padding-bottom: 5px;
}
.worker-emoji {
    font-size: 1.5rem;
    margin-right: 8px;
    cursor: pointer;
}
.worker-emoji.idle:hover {
    opacity: 0.8;
}

/* Assignment Modal */
#assignment-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
}
#assignment-modal .modal-content {
    background: #1c1c1c;
    padding: 20px;
    border-radius: 8px;
    width: 300px;
    max-height: 80%;
    overflow: auto;
}
.structure-card {
    background: #282828;
    padding: 10px;
    margin: 5px 0;
    border-radius: 4px;
    cursor: pointer;
}
.structure-card:hover {
    background: #333;
}

/* Worker Cards in Workers Tab */
.worker-card {
    background: #1e1e1e;
    padding: 10px;
    margin: 10px 0;
    border: 1px solid #1ec469;
    border-radius: 5px;
    color: #fff;
}
.worker-card .status-active {
    color: #2e7d32;
}
.worker-card .status-idle {
    color: #ffeb3b;
}
.worker-card .status-unpaid {
    color: #f44336;
}
.worker-card button {
    margin-left: 5px; padding: 5px 8px; background-color: #666;
    border: none; color: white; border-radius: 3px;
}
.worker-card button:hover { background-color: #777; opacity: 1; }

/* Smaller Farm Workers card styling overrides */
#farm-activities-container .worker-card {
    padding: 5px;
    margin-bottom: 5px;
    font-size: 0.9em;
}
#farm-activities-container .worker-header {
    display: inline-flex;
    width: fit-content;
    align-items: center;
    margin-bottom: 5px;
}
#farm-activities-container .worker-emoji {
    font-size: 18px;
    margin-right: 5px;
}
#farm-activities-container .worker-actions button {
    padding: 3px 6px;
    margin-left: 3px;
    font-size: 0.85em;
}
#farm-activities-container .worker-assignment,
#farm-activities-container .worker-dates {
    font-size: 0.85em;
    margin-top: 4px;
}
#farm-activities-container .status-text {
    font-size: 0.8em;
    padding: 2px 4px;
    margin-left: 5px;
}

/* Worker status and hire card borders */
#farm-activities-container .status-text.status-idle {
    border: 1px solid #ffeb3b;
    border-radius: 3px;
    padding: 2px 4px;
}
#hire-workers-container .worker-card.farmhand {
    border-color: #2196f3; /* Blue for Farmhand hire cards */
}
#hire-workers-container .worker-card.farm_manager {
    border-color: #9c27b0; /* Purple for Farm Manager hire cards */
}

/* Idle worker cards get a yellow border */
#farm-activities-container .worker-card.status-idle {
    border-color: #ffeb3b;
}
/* Arrange worker cards: active left, idle below */
#farm-activities-container #farm-workers-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}
#farm-activities-container #farm-workers-container .worker-card {
    flex: 0 1 auto;
}
#farm-activities-container #farm-workers-container .worker-card.status-active {
    order: 0;
}
#farm-activities-container #farm-workers-container .worker-card.status-idle {
    order: 1;
}

/* Worker indicator for farm overview tiles */
.worker-indicator {
    position: absolute;
    bottom: 4px;
    right: 4px;
    display: flex;
    gap: 4px;
    pointer-events: none;
    z-index: 5; /* bring worker icons above tile content */
}
.worker-indicator span {
    font-size: 1rem;
    line-height: 1;
}

/* Additional movement patterns for animal emojis */
@keyframes moveZigzag {
    0%, 100% { transform: translate(var(--dx), var(--dy)) rotate(var(--angle)) scale(1); }
    25% { transform: translate(calc(-1 * var(--dx)), var(--dy)) rotate(calc(-1 * var(--angle))) scale(1.1); }
    50% { transform: translate(calc(-1 * var(--dx)), calc(-1 * var(--dy))) rotate(var(--angle)) scale(0.9); }
    75% { transform: translate(var(--dx), calc(-1 * var(--dy))) rotate(calc(-1 * var(--angle))) scale(1.05); }
}
@keyframes moveBounce {
    0%, 100% { transform: translate(0, 0) scale(1); }
    50% { transform: translate(0, calc(var(--dy) * 0.5)) scale(1.2); }
}
/* Slow drifting movement for variety */
@keyframes moveDrift {
    0%, 100% { transform: translate(calc(var(--dx)*0.5), calc(var(--dy)*0.5)) rotate(calc(var(--angle)*0.5)) scale(1); }
    33% { transform: translate(calc(var(--dx) * 0.8), calc(var(--dy) * 0.8)) rotate(calc(var(--angle) * 0.8)) scale(1.1); }
    66% { transform: translate(calc(-1 * var(--dx) * 0.8), calc(-1 * var(--dy) * 0.8)) rotate(calc(-1 * var(--angle) * 0.8)) scale(0.9); }
}

/* === Custom Farm Overview UI Enhancements === */
#overview-content {
    background: #2c2c2c;
    border: 1px solid #444;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 1040px;
    margin: 10px auto;
}
#overview-content #hired-workers-overview {
    margin-bottom: 20px;
}
.farm-overview-map {
    background: #1e1e1e;
    padding: 15px;
    border-radius: 6px;
}
.farm-tile {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.farm-tile:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(0,0,0,0.6);
}
.farm-tile .tile-label {
    background: rgba(0,0,0,0.7);
    padding: 2px 4px;
    border-radius: 3px;
}

/* Crop Plot Emoji Size Adjustment */
.plot-tile .tile-content span {
    font-size: 0.8em;
}

/* Hired Workers Overview: Specific Section Styles */
#hired-workers-overview .hwo-section:nth-of-type(2),
#hired-workers-overview .hwo-section:nth-of-type(3) {
    background: #444 !important;
}
#hired-workers-overview .hwo-section:nth-of-type(2) h4,
#hired-workers-overview .hwo-section:nth-of-type(3) h4 {
    color: #fff !important;
    border-bottom-color: #555 !important;
}
/* Hired Workers Overview: Idle Workers Dark Background */
#hired-workers-overview .hwo-section:nth-of-type(1) {
    background: #444 !important;
}
#hired-workers-overview .hwo-section:nth-of-type(1) h4 {
    color: #fff !important;
    border-bottom-color: #555 !important;
}

/* Hired Workers Overview: Emoji Background to Match Tile Color */
#hired-workers-overview .worker-emoji {
    background: #222 !important;
    border-radius: 4px;
    padding: 4px;
}

/* Hired Workers Overview: Reset Idle Workers Header Color */
#hired-workers-overview .hwo-section:nth-of-type(1) h4 {
    color: #ffd700 !important;
    border-bottom-color: #4caf50 !important;
}

/* Hired Workers Overview: Header Layout for Manager Emoji on Right */
#hired-workers-overview .hwo-section h4 {
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.manager-emoji {
    margin-left: 8px;
}

/* Farm Overview Tooltips */
.farm-tile:hover .custom-tooltip-text {
    z-index: 100000 !important; /* ensure tooltip sits above all tile elements */
    opacity: 1; visibility: visible; transform: translateX(-50%) translateY(-12px);
    min-width: 140px;
}

/* Center emojis inside crop or plot tiles */
.plot-tile .tile-content {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    flex-wrap: wrap !important;
    gap: 4px;
}

/* Ensure crop plot tooltips overlay labels and icons */
.farm-tile .tile-label,
.farm-tile .worker-indicator {
    z-index: 0 !important;
}

/* Crop Plot Timer Display */
.crop-plot-slot .plot-timer {
    color: #ccc;
    font-size: 12px;
    text-align: center;
    margin: 4px 0;
}
/* Move Crop Plot Timer into header corner */
.crop-plot-slot .plot-header {
    position: relative;
    padding-right: 50px;
}
.crop-plot-slot .plot-header .plot-timer {
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    margin: 0;
    text-align: right;
}

/* Farming Tab Emojis */
#overview-tab::before { content: "🗺️"; margin-right: 6px;}
#animal-management-tab::before { content: "🐄"; margin-right: 6px; }
#crop-management-tab::before { content: "🌾"; margin-right: 6px; }
#farm-workers-tab::before { content: "🧑‍🌾"; margin-right: 6px; }
#storage-tab::before { content: "📦"; margin-right: 6px; }

/* Override HWO worker emojis to be 20% smaller */
#hired-workers-overview .worker-emoji {
    font-size: 1.2rem !important;
}

/* Shrink both Animal Manager and Crop Manager icons by 20% */
.manager-emoji[title="Animal Manager"],
.manager-emoji[title="Crop Manager"] {
    font-size: 0.8em !important;
}

#overview-tab {
    background-color: rgba(23, 106, 190, 0.85);
}

#animal-management-tab {
    background-color: rgba(127, 255, 212, 0.49)
}

#crop-management-tab {
    background-color: rgba(127, 255, 129, 0.47);
}

#farm-workers-tab {
    background-color: rgba(6, 64, 215, 0.49);
}
#storage-tab{
    background-color: rgba(245, 245, 220, 0.47)
}
/* Perk cost list spacing */
.perk-cost ul {
    padding-left: 20px;
    margin-top: 5px;
}
/* Colorize Have amounts based on sufficiency */
.have.enough {
    color: #4caf50 !important;
}
.have.missing {
    color: #f44336 !important;
}
/* Ensure 'Have:' counts in cooking recipes are color-coded over the ingredient default */
.recipe-ingredient .have-enough {
    color: #4caf50 !important;
}
.recipe-ingredient .have-not-enough {
    color: #f44336 !important;
}
.action-item-ingredients .have-enough {
    color: #4caf50 !important;
}
.action-item-ingredients .have-not-enough {
    color: #f44336 !important;
}
#available-food-list .resource-max-craft {
    margin-left: 0 !important;
    text-align: left !important;
    padding-left: 0 !important;
    margin-top: 4px !important;
}
.recipe-requirements {
    display: flex;
    flex-direction: column;
    gap: 2px;
    margin-bottom: 8px;
}
.recipe-requirements .action-item-ingredients {
    font-size: 0.9em;
    color: #ccc;
    margin: 0;
}
.action-item-right {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    text-align: right;
}
.action-item-right .resource-inventory-count {
    margin-top: auto;
}

/* ===== ENCHANTING SYSTEM STYLES ===== */

/* Main Layout Container */
.enchanting-main-container {
    display: flex;
    gap: 20px;
    margin: 20px 0;
    min-height: 500px;
}

/* Left Panel - Equipment Grid */
.enchanting-left-panel {
    flex: 0 0 300px;
    background-color: #252526;
    border: 1px solid #444;
    border-radius: 8px;
    padding: 15px;
}

.enchanting-left-panel .section-title {
    color: #fff;
    font-size: 1.2em;
    font-weight: bold;
    margin-bottom: 15px;
    border-bottom: 2px solid #4CAF50;
    padding-bottom: 8px;
}

/* Equipment Grid (copied from character info) */
.enchanting-equipment-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-top: 15px;
}

.enchanting-equipment-slot {
    background-color: #333;
    border: 2px solid #555;
    border-radius: 8px;
    padding: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    min-height: 120px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.enchanting-equipment-slot:hover {
    border-color: #4CAF50;
    background-color: #3a3a3a;
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
}

.enchanting-equipment-slot.selected {
    border-color: #4CAF50;
    background-color: #2d4a2d;
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
    z-index: 2;
}

.enchanting-equipment-slot.equipment-slot-empty {
    background-color: #2a2a2a;
    border-color: #444;
    cursor: default;
    opacity: 0.6;
}

.enchanting-equipment-slot.equipment-slot-empty:hover {
    border-color: #444;
    background-color: #2a2a2a;
    transform: none;
    box-shadow: none;
}

.enchanting-slot-name {
    font-size: 0.8em;
    color: #bbb;
    margin-bottom: 5px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.enchanting-slot-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    justify-content: center;
}

.enchanting-item-name {
    font-size: 0.9em;
    font-weight: bold;
    color: #fff;
    margin-bottom: 5px;
    text-align: center;
}

.enchanting-item-icon {
    font-size: 2em;
    margin: 8px 0;
}

.enchanting-item-icon img {
    width: 32px;
    height: 32px;
    object-fit: contain;
}

.enchanting-item-stats {
    font-size: 0.75em;
    color: #ccc;
    text-align: center;
    line-height: 1.2;
}

.enchanting-item-enchanted {
    font-size: 0.7em;
    color: #9C27B0;
    font-style: italic;
    margin-top: 3px;
}

/* Right Panel - Enchanting Interface */
.enchanting-right-panel {
    flex: 1;
    background-color: #252526;
    border: 1px solid #444;
    border-radius: 8px;
    padding: 15px;
    position: relative;
}

.enchanting-panel {
    margin-bottom: 20px;
}

.enchanting-panel .section-title {
    color: #fff;
    font-size: 1.1em;
    font-weight: bold;
    margin-bottom: 12px;
    border-bottom: 2px solid #4CAF50;
    padding-bottom: 6px;
}

/* Default Prompt */
.enchanting-prompt {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 300px;
    text-align: center;
}

.enchanting-prompt-icon {
    font-size: 4em;
    margin-bottom: 20px;
    opacity: 0.5;
}

.enchanting-prompt-text {
    font-size: 1.2em;
    color: #999;
    font-style: italic;
}

/* Selected Item Display */
.selected-item-card {
    background-color: #2a2a2a;
    border: 2px solid #4CAF50;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
}

.selected-item-card .item-name {
    font-size: 1.2em;
    font-weight: bold;
    color: #4CAF50;
    margin-bottom: 5px;
}

.selected-item-card .item-type {
    font-size: 0.9em;
    color: #bbb;
    text-transform: uppercase;
}

/* Stats Display */
.item-stats-display {
    background-color: #1e1e1e;
    border: 1px solid #444;
    border-radius: 6px;
    padding: 12px;
    margin: 10px 0;
}

.stats-section-title {
    font-size: 1em;
    font-weight: bold;
    color: #fff;
    margin-bottom: 8px;
    border-bottom: 1px solid #555;
    padding-bottom: 4px;
}

.base-stats-section, .enchanted-stats-section {
    margin-bottom: 10px;
}

.base-stat-line {
    color: #ddd;
    font-size: 0.9em;
    margin: 3px 0;
}

.enchantment-line {
    font-size: 0.9em;
    margin: 3px 0;
    font-weight: bold;
}

.no-enchantments {
    color: #777;
    font-style: italic;
    font-size: 0.9em;
}

/* Enchantment Tier Options */
.enchanting-tier-option {
    background-color: #2a2a2a;
    border: 2px solid #555;
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
    transition: all 0.3s ease;
}

.enchanting-tier-option:hover {
    border-color: #4CAF50;
    background-color: #333;
}

.enchanting-tier-option.disabled {
    background-color: #1a1a1a;
    border-color: #333;
    opacity: 0.5;
    cursor: not-allowed;
}

.enchanting-tier-option.disabled:hover {
    border-color: #333;
    background-color: #1a1a1a;
}

.tier-option-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.tier-option-name {
    font-size: 1.1em;
    font-weight: bold;
    color: #fff;
}

.tier-option-level {
    font-size: 0.9em;
    color: #4CAF50;
    background-color: #1e1e1e;
    padding: 3px 8px;
    border-radius: 4px;
}

.tier-option-description {
    color: #bbb;
    font-size: 0.9em;
    margin-bottom: 8px;
    line-height: 1.4;
}

.tier-option-cost {
    color: #FFD700;
    font-size: 0.9em;
    margin-bottom: 8px;
    font-weight: bold;
}

.tier-option-potential {
    color: #9C27B0;
    font-size: 0.85em;
    margin-bottom: 12px;
    line-height: 1.3;
}

/* Enchant Button */
.enchant-button {
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 10px 20px;
    font-size: 1em;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
}

.enchant-button:hover {
    background-color: #45a049;
    transform: translateY(-1px);
    box-shadow: 0 3px 6px rgba(0,0,0,0.3);
}

.enchant-button.disabled {
    background-color: #555;
    color: #999;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.enchant-button.disabled:hover {
    background-color: #555;
    transform: none;
    box-shadow: none;
}

/* Choice Buttons */
.enchanting-choice-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 15px;
}

.enchanting-choice-buttons button {
    flex: 1;
    padding: 12px 20px;
    font-size: 1em;
    font-weight: bold;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background-color: #5a6268;
    transform: translateY(-1px);
}

/* Enchanting Comparison Display */
.enchanting-comparison-display {
    display: flex;
    gap: 20px;
    margin: 15px 0;
}

.enchanting-current-side,
.enchanting-new-side {
    flex: 1;
    background-color: #2a2a2a;
    border: 2px solid #555;
    border-radius: 8px;
    padding: 15px;
}

.enchanting-current-side {
    border-color: #4a4a4a;
}

.enchanting-new-side {
    border-color: #4CAF50;
}

.comparison-title {
    font-size: 1.1em;
    font-weight: bold;
    margin-bottom: 10px;
    text-align: center;
    color: #fff;
}

.enchanting-new-side .comparison-title {
    color: #4CAF50;
}

.btn-primary {
    background-color: #007bff;
    color: white;
}

.btn-primary:hover {
    background-color: #0056b3;
    transform: translateY(-1px);
}

/* Resource List Overrides for Enchanting */
.enchanting-section .resource-list {
    background-color: #252526;
    border: 1px solid #444;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
}

.enchanting-section .section-title {
    color: #fff !important;
    margin-bottom: 15px !important;
    font-size: 1.2em !important;
    border-bottom: 2px solid #4CAF50 !important;
    padding-bottom: 8px !important;
}

/* Permit Status for Enchanting */
.enchanting-section .permit-status {
    background-color: #1e1e1e;
    border: 1px solid #4CAF50;
    border-radius: 8px;
    padding: 12px;
    margin: 15px 0;
}

.permit-status-content {
    display: flex;
    gap: 15px;
    align-items: center;
    flex-wrap: wrap;
}

.permit-status-label {
    color: #bbb;
    font-size: 0.9em;
}

.permit-status-value {
    color: #4CAF50;
    font-weight: bold;
    font-size: 1em;
}

/* Responsive Design for Enchanting */
@media (max-width: 768px) {
    .enchanting-main-container {
        flex-direction: column;
        gap: 15px;
    }
    
    .enchanting-left-panel {
        flex: none; /* Allow it to shrink if needed, or set specific width/height */
        order: 2;   /* Display equipment selection below the main panel on mobile */
    }
    
    .enchanting-right-panel {
        order: 1;
    }
    
    .enchanting-equipment-grid {
        grid-template-columns: 1fr; /* Stack equipment slots vertically */
        gap: 10px;
    }
    
    .enchanting-choice-buttons {
        flex-direction: column; /* Stack choice buttons vertically */
    }
    
    .permit-status-content {
        flex-direction: column; /* Stack permit status items */
        gap: 8px;
        align-items: flex-start;
    }
    
    .tier-option-header {
        flex-direction: column; /* Stack tier option header items */
        align-items: flex-start;
        gap: 5px;
    }
}

/* End of Enchanting styles */

/* Additional Responsive Adjustments if they were missed or for more specific cases */
@media (max-width: 900px) {
    body:not(.desktop-mode-active) #hud {
        /* Styles from your original file - ensure they are here */
    }
    /* other 900px styles */
}

@media (max-width: 768px) {
    body:not(.desktop-mode-active) .shop-grid {
        /* Styles from your original file - ensure they are here */
    }
    /* other 768px styles */
}

@media (max-width: 480px) {
    body:not(.desktop-mode-active) {
        /* Styles from your original file - ensure they are here */
    }
    /* other 480px styles */
}

/* Item Border Tiers */
.item-border.tier-common { border: 3px solid grey; }
.item-border.tier-uncommon { border: 3px solid green; }
.item-border.tier-rare { border: 3px solid blue; }
.item-border.tier-epic { border: 3px solid purple; }
.item-border.tier-legendary { border: 3px solid orange; }
.item-border.tier-mythic { border: 3px solid gold; }

/* Eat Food Modal List Styling */
#eat-food-modal .resource-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 10px;
    max-height: 550px;
    overflow-y: auto;
    padding-right: 10px;
}
#eat-food-modal .resource-list .inventory-item {
    padding: 8px;
    min-height: auto;
    text-align: center;
}
#eat-food-modal .resource-list .inventory-item .item-info {
    flex: none;
    width: auto;
}
#eat-food-modal .resource-list .inventory-item .item-name {
    white-space: normal;
    overflow: visible;
    text-overflow: clip;
    font-size: 0.9em;
}
#eat-food-modal .resource-list .item-quantity {
     font-size: 0.8em;
}
#eat-food-modal .resource-list .item-icon {
    margin-bottom: 4px;
    font-size: 1.6em;
}
#eat-food-modal .resource-list .item-details {
    font-size: 0.8em;
    margin-top: 2px;
}
#eat-food-modal .resource-list .food-heal-text {
    color: #4ade80;
    font-weight: bold;
}
#eat-food-modal .resource-list .food-eat-btn {
    margin-top: 8px;
    padding: 4px 8px;
    font-size: 0.85em;
    width: auto;
}

/* Chest Opening Modal Styles */
.chest-modal {
    text-align: center;
    padding: 30px;
    min-width: 400px;
    background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
}

.chest-animation-container {
    position: relative;
    height: 120px;
    margin-bottom: 20px;
}

.chest-icon {
    font-size: 80px;
    animation: chestOpen 0.5s ease-out;
    display: inline-block;
}

@keyframes chestOpen {
    0% { transform: scale(0.8) rotate(-5deg); }
    50% { transform: scale(1.2) rotate(5deg); }
    100% { transform: scale(1) rotate(0deg); }
}

/* Tier-specific chest icon colors */
.chest-icon.tier-common { color: #c0c0c0; }
.chest-icon.tier-uncommon { color: #22c55e; }
.chest-icon.tier-rare { color: #3b82f6; }
.chest-icon.tier-epic { color: #a855f7; }
.chest-icon.tier-legendary { 
    color: #fbbf24;
    text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
}

#chest-title {
    font-size: 24px;
    margin-bottom: 20px;
}

#chest-loot-list {
    max-height: 300px;
    overflow-y: auto;
    margin: 20px 0;
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
}

.chest-loot-item {
    padding: 8px;
    margin: 5px 0;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
    border-left: 3px solid;
    opacity: 0;
    animation: fadeInSlide 0.3s ease-out forwards;
}

@keyframes fadeInSlide {
    from {
        opacity: 0;
        transform: translateX(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Loot item tier colors */
.chest-loot-item .tier-common { border-left-color: #c0c0c0; }
.chest-loot-item .tier-uncommon { border-left-color: #22c55e; }
.chest-loot-item .tier-rare { border-left-color: #3b82f6; }
.chest-loot-item .tier-epic { border-left-color: #a855f7; }
.chest-loot-item .tier-legendary { border-left-color: #fbbf24; }

/* Particle effects for legendary chests */
.chest-particles {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.chest-modal .tier-legendary .chest-particles::before,
.chest-modal .tier-legendary .chest-particles::after {
    content: '✨';
    position: absolute;
    font-size: 20px;
    animation: sparkle 2s infinite;
}

.chest-modal .tier-legendary .chest-particles::before {
    top: 20%;
    left: 30%;
    animation-delay: 0s;
}

.chest-modal .tier-legendary .chest-particles::after {
    top: 30%;
    right: 30%;
    animation-delay: 1s;
}

@keyframes sparkle {
    0%, 100% { opacity: 0; transform: scale(0); }
    50% { opacity: 1; transform: scale(1); }
}

.success-button {
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    color: white;
    padding: 10px 30px;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}

.success-button:hover {
    background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
}

/* Enhanced Guild Hall Tab Styling */
#guild-hall-section .tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
    background: linear-gradient(to bottom, #1a1a1d 0%, #2d2d30 100%);
    padding: 8px;
    border-radius: 12px;
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
}

#guild-hall-section .tab {
    background: linear-gradient(135deg, #3e3e42 0%, #2d2d30 100%);
    color: #b0b0b0;
    border: 1px solid #444;
    border-radius: 8px;
    padding: 12px 24px;
    font-weight: 600;
    font-size: 15px;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

#guild-hall-section .tab::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.5s;
}

#guild-hall-section .tab:hover {
    background: linear-gradient(135deg, #4a4a4e 0%, #3e3e42 100%);
    color: #fff;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

#guild-hall-section .tab:hover::before {
    left: 100%;
}

#guild-hall-section .tab.active {
    background: linear-gradient(135deg, #4b8bff 0%, #0e639c 100%);
    color: white;
    border-color: #4b8bff;
    box-shadow: 0 4px 12px rgba(75, 139, 255, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2);
    transform: translateY(0);
}

#guild-hall-section .tab.active:hover {
    transform: translateY(0);
    box-shadow: 0 4px 15px rgba(75, 139, 255, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

/* Enhanced Recruit Member Button */
.guild-action-button {
    background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
    color: white;
    border: none;
    border-radius: 10px;
    padding: 14px 32px;
    font-size: 16px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2);
    position: relative;
    overflow: hidden;
    margin: 20px auto;
    display: block;
}


.guild-action-button::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.guild-action-button:hover {
    background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(34, 197, 94, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.guild-action-button:hover::after {
    width: 300px;
    height: 300px;
}

.guild-action-button:active {
    transform: translateY(-1px);
    box-shadow: 0 2px 10px rgba(34, 197, 94, 0.3);
}

/* Specific styling for Recruit button */
#recruit-member-button {
    padding-left: 48px; /* Make room for the emoji */
}

/* Optional: Add pulsing animation to draw attention */
@keyframes pulse {
    0% { box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2); }
    50% { box-shadow: 0 4px 25px rgba(34, 197, 94, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.3); }
    100% { box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2); }
}

.guild-action-button:not(:hover) {
    animation: pulse 3s infinite;
}

/* ===== Gem Conversion Styles ===== */
.gem-conversion-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.gem-conversion-info {
    margin: 20px 0;
    padding: 15px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    border-left: 4px solid #ffd700;
}

.gem-conversion-info p {
    margin: 5px 0;
    color: #ffffff;
}

.gem-conversion-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.gem-conversion-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    border: 2px solid;
    transition: all 0.3s ease;
}

.gem-conversion-card.uncommon {
    border-color: #22c55e;
    background: rgba(34, 197, 94, 0.1);
}

.gem-conversion-card.rare {
    border-color: #3b82f6;
    background: rgba(59, 130, 246, 0.1);
}

.gem-conversion-card.epic {
    border-color: #a855f7;
    background: rgba(168, 85, 247, 0.1);
}

.gem-conversion-card.legendary {
    border-color: #f59e0b;
    background: rgba(245, 158, 11, 0.1);
}

.gem-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.gem-name {
    font-size: 1.2em;
    font-weight: bold;
    color: #ffffff;
}

.gem-amount {
    font-size: 1em;
    color: #ffd700;
    font-weight: 600;
}

.gem-conversion-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.gem-conversion-btn {
    padding: 12px 15px;
    border: 2px solid;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.1);
    color: #ffffff;
    font-size: 0.95em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: center;
    line-height: 1.4;
}

.gem-conversion-btn.upgrade {
    border-color: #22c55e;
    background: rgba(34, 197, 94, 0.2);
}

.gem-conversion-btn.upgrade:hover:not(.disabled) {
    background: rgba(34, 197, 94, 0.3);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
}

.gem-conversion-btn.downgrade {
    border-color: #ef4444;
    background: rgba(239, 68, 68, 0.2);
}

.gem-conversion-btn.downgrade:hover:not(.disabled) {
    background: rgba(239, 68, 68, 0.3);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
}

.gem-conversion-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background: rgba(100, 100, 100, 0.2);
    border-color: #666666;
    color: #999999;
}

.gem-conversion-btn small {
    display: block;
    font-size: 0.8em;
    margin-top: 2px;
    opacity: 0.9;
}

/* ===== Gems Button Special Styling ===== */
#gems-conversion-btn {
    position: relative;
    background: 
        linear-gradient(135deg, 
            #22c55e 0%,      /* Green (Assorted Gems) */
            #3b82f6 20%,     /* Blue (Sapphire) */
            #10b981 40%,     /* Emerald green */
            #ef4444 60%,     /* Red (Ruby) */
            #8b5cf6 80%,     /* Purple (Diamond) */
            #f59e0b 100%     /* Gold (Dragon Gem) */
        ),
        /* Gem facet overlay patterns for crystalline texture */
        linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 32%, rgba(255,255,255,0.3) 34%, transparent 36%),
        linear-gradient(-45deg, transparent 30%, rgba(255,255,255,0.1) 32%, rgba(255,255,255,0.2) 34%, transparent 36%),
        linear-gradient(90deg, transparent 40%, rgba(255,255,255,0.1) 42%, transparent 44%);
    background-size: 200% 200%, 20px 20px, 25px 25px, 15px 15px;
    border: 2px solid transparent;
    border-radius: 0;
    /* Gem shape using clip-path - octagonal gem cut */
    clip-path: polygon(
        20% 0%, 
        80% 0%, 
        100% 30%, 
        100% 70%, 
        80% 100%, 
        20% 100%, 
        0% 70%, 
        0% 30%
    );
    color: #ffffff;
    font-weight: bold;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
    box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3),
        inset 2px 2px 4px rgba(255, 255, 255, 0.2),
        inset -2px -2px 4px rgba(0, 0, 0, 0.1);
    transition: all 0.4s ease;
    animation: gemShimmer 3s ease-in-out infinite;
    overflow: visible;
    min-width: 80px;
    min-height: 40px;
}

#gems-conversion-btn::before {
    content: '';
    position: absolute;
    top: -3px;
    left: -3px;
    right: -3px;
    bottom: -3px;
    background: linear-gradient(135deg, 
        #22c55e, #3b82f6, #10b981, #ef4444, #8b5cf6, #f59e0b
    );
    background-size: 400% 400%;
    border-radius: 0;
    /* Match the gem shape for the border */
    clip-path: polygon(
        20% 0%, 
        80% 0%, 
        100% 30%, 
        100% 70%, 
        80% 100%, 
        20% 100%, 
        0% 70%, 
        0% 30%
    );
    z-index: -1;
    animation: gemBorderFlow 4s ease-in-out infinite;
}

#gems-conversion-btn:hover {
    transform: translateY(-2px) scale(1.05);
    box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.4),
        0 0 20px rgba(139, 92, 246, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    animation: gemPulse 1.5s ease-in-out infinite, gemShimmer 1s ease-in-out infinite;
}

#gems-conversion-btn:hover::before {
    animation: gemBorderFlow 1s ease-in-out infinite;
}

#gems-conversion-btn:active {
    transform: translateY(-1px) scale(1.02);
    box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.3),
        0 0 15px rgba(139, 92, 246, 0.4);
}

/* Gem button animations */
@keyframes gemShimmer {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes gemBorderFlow {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes gemPulse {
    0% { 
        box-shadow: 
            0 8px 25px rgba(0, 0, 0, 0.4),
            0 0 20px rgba(139, 92, 246, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }
    50% { 
        box-shadow: 
            0 10px 30px rgba(0, 0, 0, 0.5),
            0 0 30px rgba(245, 158, 11, 0.5),
            0 0 40px rgba(59, 130, 246, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }
    100% { 
        box-shadow: 
            0 8px 25px rgba(0, 0, 0, 0.4),
            0 0 20px rgba(139, 92, 246, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }
}

/* ===== Achievements System Styles ===== */
.achievements-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.achievements-summary {
    display: flex;
    justify-content: space-around;
    margin: 20px 0;
    padding: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    border: 2px solid #ffd700;
}

.achievement-stat {
    text-align: center;
    color: #ffffff;
}

.achievement-stat-value {
    font-size: 2em;
    font-weight: bold;
    color: #ffd700;
    display: block;
}

.achievement-stat-label {
    font-size: 0.9em;
    opacity: 0.9;
    margin-top: 5px;
}

.achievements-list {
    margin-top: 30px;
}

.achievement-category {
    margin-bottom: 30px;
}

.achievement-category-title {
    color: #ffd700;
    font-size: 1.4em;
    margin-bottom: 15px;
    padding-bottom: 8px;
    border-bottom: 2px solid rgba(255, 215, 0, 0.3);
}

.achievement-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 20px;
}

.achievement-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    border: 2px solid;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.achievement-card.common {
    border-color: #9ca3af;
    background: rgba(156, 163, 175, 0.1);
}

.achievement-card.uncommon {
    border-color: #22c55e;
    background: rgba(34, 197, 94, 0.1);
}

.achievement-card.rare {
    border-color: #3b82f6;
    background: rgba(59, 130, 246, 0.1);
}

.achievement-card.epic {
    border-color: #a855f7;
    background: rgba(168, 85, 247, 0.1);
}

.achievement-card.legendary {
    border-color: #f59e0b;
    background: rgba(245, 158, 11, 0.1);
}

.achievement-card.completed {
    border-color: #10b981;
    background: rgba(16, 185, 129, 0.2);
    box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
}

.achievement-card.completed::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
    animation: completedShine 3s ease-in-out infinite;
    pointer-events: none;
}

.achievement-icon {
    font-size: 3em;
    text-align: center;
    margin-bottom: 15px;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.achievement-content {
    text-align: center;
}

.achievement-name {
    font-size: 1.2em;
    font-weight: bold;
    color: #ffffff;
    margin-bottom: 8px;
}

.achievement-description {
    font-size: 0.9em;
    color: #cccccc;
    margin-bottom: 15px;
    line-height: 1.4;
}

.achievement-progress {
    margin-bottom: 10px;
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 5px;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #22c55e, #10b981);
    border-radius: 4px;
    transition: width 0.3s ease;
}

.achievement-card.completed .progress-fill {
    background: linear-gradient(90deg, #10b981, #059669);
}

.progress-text {
    font-size: 0.8em;
    color: #ffd700;
    font-weight: 600;
}

.achievement-completed {
    background: #10b981;
    color: #ffffff;
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 0.8em;
    font-weight: bold;
    margin-top: 10px;
    display: inline-block;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
}

.achievement-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
}

.achievement-card.completed:hover {
    box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
}

/* Achievement completion animation */
@keyframes completedShine {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

/* Responsive design */
@media (max-width: 768px) {
    .achievement-grid {
        grid-template-columns: 1fr;
    }
    
    .achievements-summary {
        flex-direction: column;
        gap: 15px;
    }
    
    .achievement-stat {
        padding: 10px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
    }
}

/* Achievement Notification */
#achievement-notification {
    position: fixed;
    top: 0;
    left: 50%;
    transform: translateX(-50%) translateY(-100%);
    background-color: rgba(0, 0, 0, 0.8);
    color: #fff;
    padding: 10px 20px;
    border-radius: 0 0 5px 5px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    opacity: 0;
    transition: transform 0.4s ease, opacity 0.4s ease;
    z-index: 10000;
    cursor: pointer;
}
#achievement-notification.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
}